<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f628065b851287e306e5.css" id="gatsby-global-css">@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:100;src:local("IBM Plex Sans Thin "),local("IBM Plex Sans-Thin"),url(/static/ibm-plex-sans-latin-100-245539db8ee56425757ef728eda8194e.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-100-9a582f3a304f421eca4027517706843c.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:100;src:local("IBM Plex Sans Thin italic"),local("IBM Plex Sans-Thinitalic"),url(/static/ibm-plex-sans-latin-100italic-3c34cf080b38f5fb1d4c59ffa45b3967.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-100italic-1ea7c5d21b5956b602bdf9656cfb353f.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:200;src:local("IBM Plex Sans Extra Light "),local("IBM Plex Sans-Extra Light"),url(/static/ibm-plex-sans-latin-200-bf72c8412ab06c393f52efc5beb26ea7.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-200-67524c36348a323f78f2845e3aafc2d4.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:200;src:local("IBM Plex Sans Extra Light italic"),local("IBM Plex Sans-Extra Lightitalic"),url(/static/ibm-plex-sans-latin-200italic-bbc2d55223638ce450424a917e1104b2.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-200italic-52df25607ec284ca361ae50ba24b3580.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:300;src:local("IBM Plex Sans Light "),local("IBM Plex Sans-Light"),url(/static/ibm-plex-sans-latin-300-9e1c48af24191f6ea8aede14957c5d01.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-300-10bb6a0ae6dc8000d999ab622a45e281.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:300;src:local("IBM Plex Sans Light italic"),local("IBM Plex Sans-Lightitalic"),url(/static/ibm-plex-sans-latin-300italic-c76f2ab53673e964b6e6734c1c455761.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-300italic-d3566d5bb4f31d86bfb9fda09563b416.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:400;src:local("IBM Plex Sans Regular "),local("IBM Plex Sans-Regular"),url(/static/ibm-plex-sans-latin-400-263d6267533501f58c33b12b382e3abb.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-400-a2c56f946488a9a267ba6ba21471a217.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:400;src:local("IBM Plex Sans Regular italic"),local("IBM Plex Sans-Regularitalic"),url(/static/ibm-plex-sans-latin-400italic-89a93a1bdde48c7bb104150de88affce.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-400italic-272f86114c980c52c131dfc3b4ae3276.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:500;src:local("IBM Plex Sans Medium "),local("IBM Plex Sans-Medium"),url(/static/ibm-plex-sans-latin-500-0866c24487514ad726738fb24f8e015b.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-500-f6d5c5d5b849796d6a8f5a2953b60753.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:500;src:local("IBM Plex Sans Medium italic"),local("IBM Plex Sans-Mediumitalic"),url(/static/ibm-plex-sans-latin-500italic-ffd12d59339823b8cf53b9f99b47d87c.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-500italic-ccd41bd1a5bfa8bad2cd8d35fdaeb3d1.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:600;src:local("IBM Plex Sans SemiBold "),local("IBM Plex Sans-SemiBold"),url(/static/ibm-plex-sans-latin-600-7852d4dc26ef44df58e23dc0b9722d6f.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-600-337b16517a230dc830b84dc6e6167b68.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:600;src:local("IBM Plex Sans SemiBold italic"),local("IBM Plex Sans-SemiBolditalic"),url(/static/ibm-plex-sans-latin-600italic-17e5379fd9a99b9bcb26ea983f391b6a.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-600italic-6f4ba6aa87fa99d5bc2b90a7b40a0ded.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:700;src:local("IBM Plex Sans Bold "),local("IBM Plex Sans-Bold"),url(/static/ibm-plex-sans-latin-700-c9983d3d04f3ed6c2eafee1db1d24e06.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-700-b8809d619a33eb825b0450281ff752e7.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:700;src:local("IBM Plex Sans Bold italic"),local("IBM Plex Sans-Bolditalic"),url(/static/ibm-plex-sans-latin-700italic-02954beec9e742bb1f3ae27b7e7cb71f.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-700italic-72e9af409ddafc63a5dd380e34758560.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="Minimal Blog - @lekoarts/gatsby-theme-minimal-blog" href="/rss.xml"/><title data-react-helmet="true">Kubernetes By Example (GKE) | Ben Sooraj</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><meta data-react-helmet="true" name="description" content="Note : This is a journal of my learnings as I walk through the entire  Kubernetes By Example  exercises on  Google Kubernetes Engine . I had…"/><meta data-react-helmet="true" name="image" content="https://bensooraj.com/banner.jpg"/><meta data-react-helmet="true" property="og:title" content="Kubernetes By Example (GKE)"/><meta data-react-helmet="true" property="og:url" content="https://bensooraj.com/kubernetes-by-example-gke"/><meta data-react-helmet="true" property="og:description" content="Note : This is a journal of my learnings as I walk through the entire  Kubernetes By Example  exercises on  Google Kubernetes Engine . I had…"/><meta data-react-helmet="true" property="og:image" content="https://bensooraj.com/banner.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image:alt" content="Note : This is a journal of my learnings as I walk through the entire  Kubernetes By Example  exercises on  Google Kubernetes Engine . I had…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Kubernetes By Example (GKE)"/><meta data-react-helmet="true" name="twitter:url" content="https://bensooraj.com/kubernetes-by-example-gke"/><meta data-react-helmet="true" name="twitter:description" content="Note : This is a journal of my learnings as I walk through the entire  Kubernetes By Example  exercises on  Google Kubernetes Engine . I had…"/><meta data-react-helmet="true" name="twitter:image" content="https://bensooraj.com/banner.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Note : This is a journal of my learnings as I walk through the entire  Kubernetes By Example  exercises on  Google Kubernetes Engine . I had…"/><meta data-react-helmet="true" name="twitter:creator" content="@bensooraj"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#6B46C1"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link as="script" rel="preload" href="/webpack-runtime-55f2a76a00a71ac3be88.js"/><link as="script" rel="preload" href="/framework-cd3e1e804d552fa282ef.js"/><link as="script" rel="preload" href="/app-83334ac165a5a132fa00.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/aed2e917f30c051bccba91aa15989a75fd0bd633-550e32192ffced72d3f6.js"/><link as="script" rel="preload" href="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-2463f65b120868d2315a.js"/><link as="fetch" rel="preload" href="/page-data/kubernetes-by-example-gke/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090400250.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090400250.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/318001574.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="1hycliv">body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}</style><style data-emotion-css="tm2q0o">*{box-sizing:border-box;}body{margin:0;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="kcr4c7">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text,#2d3748);color:var(--theme-ui-colors-background,#fff);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion-css="1g597hz">.css-1g597hz{border:0;-webkit-clip:react(0 0 0 0);clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1g597hz:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading,#000);color:var(--theme-ui-colors-background,#fff);z-index:1;width:auto;height:auto;-webkit-clip:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1g597hz">Skip to content</a><style data-emotion-css="1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width:640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion-css="1wt4r56">.css-1wt4r56{margin-bottom:4rem;}@media screen and (min-width:640px){.css-1wt4r56{margin-bottom:8rem;}}</style><header class="css-1wt4r56"><style data-emotion-css="1eswzqe">.css-1eswzqe{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><style data-emotion-css="190uhut">.css-190uhut{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><div class="css-190uhut"><style data-emotion-css="dz3ojy">.css-dz3ojy{color:var(--theme-ui-colors-heading,#000);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="Ben Sooraj - Back to home" class="css-dz3ojy" href="/"><style data-emotion-css="1kmktz0">.css-1kmktz0{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width:640px){.css-1kmktz0{font-size:1.875rem;}}</style><div class="css-1kmktz0">Ben Sooraj</div></a><style data-emotion-css="af3ja4">.css-af3ja4{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;}.css-af3ja4:hover,.css-af3ja4:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-af3ja4"><style data-emotion-css="iiu7h7">.css-iiu7h7{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent,transparent);-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon,#2d3748);}.css-iiu7h7:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;-webkit-transition:transform 0.45s ease;transition:transform 0.45s ease;}.css-iiu7h7:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon,#2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon,#2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon,#2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon,#2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon,#2d3748);-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-iiu7h7"></div></button></div><style data-emotion-css="1kvspmd">.css-1kvspmd{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide,#cbd5e0);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-1kvspmd a{color:var(--theme-ui-colors-secondary,#5f6c80);}.css-1kvspmd a:hover{color:var(--theme-ui-colors-heading,#000);}</style><div class="css-1kvspmd"><style data-emotion-css="nrb238">.css-nrb238{font-size:1rem;}.css-nrb238 a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width:640px){.css-nrb238{font-size:18px;}}.css-nrb238 .active{color:var(--theme-ui-colors-heading,#000);}</style><nav class="css-nrb238"><style data-emotion-css="688a3f">.css-688a3f{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-688a3f:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-688a3f" href="/blog">Blog</a><a class="css-688a3f" href="/about">About</a></nav><style data-emotion-css="e5k4e3">.css-e5k4e3{font-size:1rem;}.css-e5k4e3 a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width:640px){.css-e5k4e3{font-size:18px;}}</style><div class="css-e5k4e3"><a href="https://twitter.com/bensooraj" class="css-688a3f">Twitter</a><a href="https://in.linkedin.com/in/bensoorajm" class="css-688a3f">Linkedin</a></div></div></header><style data-emotion-css="1o6dm8k">.css-1o6dm8k [data-name='live-editor']{font-size:1rem;}.css-1o6dm8k [data-name='live-editor'] textarea,.css-1o6dm8k [data-name='live-editor'] pre{padding:1rem !important;}.css-1o6dm8k [data-name='live-preview']{padding:calc(0.5rem + 10px) !important;background-color:#d2c7ec;}.css-1o6dm8k .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent,transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width:640px){.css-1o6dm8k .prism-code{font-size:1rem;}}@media screen and (min-width:768px){.css-1o6dm8k .prism-code{font-size:1.25rem;}}.css-1o6dm8k .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1o6dm8k .gatsby-highlight[data-language=''] .prism-code,.css-1o6dm8k .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1o6dm8k .token{display:inline-block;}.css-1o6dm8k p > code,.css-1o6dm8k li > code{background-color:var(--theme-ui-colors-gray-2,#edf2f7);color:var(--theme-ui-colors-gray-8,#2d3748);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1o6dm8k .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1,22,39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width:640px){.css-1o6dm8k .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width:768px){.css-1o6dm8k .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width:1024px){.css-1o6dm8k .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1o6dm8k .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1o6dm8k .gatsby-highlight pre code{float:left;min-width:100%;}.css-1o6dm8k .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white,#fff);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black,#000);font-size:12px;-webkit-letter-spacing:0.025rem;-moz-letter-spacing:0.025rem;-ms-letter-spacing:0.025rem;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1o6dm8k .gatsby-highlight pre[class~="language-javascript"]:before,.css-1o6dm8k .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1o6dm8k .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1o6dm8k .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1o6dm8k .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1o6dm8k .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black,#000);}.css-1o6dm8k .gatsby-highlight pre[class~="language-py"]:before,.css-1o6dm8k .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white,#fff);}.css-1o6dm8k .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1o6dm8k .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1o6dm8k .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1o6dm8k .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1o6dm8k .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1o6dm8k .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1o6dm8k .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1o6dm8k .gatsby-highlight pre[class~='language-json']:before,.css-1o6dm8k .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1o6dm8k .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1o6dm8k .gatsby-highlight > code[class*="language-"],.css-1o6dm8k .gatsby-highlight > pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1o6dm8k .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1o6dm8k .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary,#6b46c1);}.css-1o6dm8k .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1,22,39);}.css-1o6dm8k .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1o6dm8k .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black,#000);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width:640px){.css-1o6dm8k .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width:768px){.css-1o6dm8k .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width:1024px){.css-1o6dm8k .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1o6dm8k [data-name='live-preview'],.css-1o6dm8k [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width:640px){.css-1o6dm8k [data-name='live-preview'],.css-1o6dm8k [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width:768px){.css-1o6dm8k [data-name='live-preview'],.css-1o6dm8k [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width:1024px){.css-1o6dm8k [data-name='live-preview'],.css-1o6dm8k [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1o6dm8k .token-line{padding-right:1rem;}.css-1o6dm8k .highlight-line{background-color:rgb(2,55,81);border-left:4px solid rgb(2,155,206);}.css-1o6dm8k .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1o6dm8k .react-live-wrapper{position:relative;}.css-1o6dm8k .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width:640px){.css-1o6dm8k .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width:768px){.css-1o6dm8k .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width:1024px){.css-1o6dm8k .react-live-wrapper .code-copy-button{right:-1rem;}}</style><style data-emotion-css="1mcymz">.css-1mcymz{box-sizing:border-box;margin:0;min-width:0;}.css-1mcymz [data-name='live-editor']{font-size:1rem;}.css-1mcymz [data-name='live-editor'] textarea,.css-1mcymz [data-name='live-editor'] pre{padding:1rem !important;}.css-1mcymz [data-name='live-preview']{padding:calc(0.5rem + 10px) !important;background-color:#d2c7ec;}.css-1mcymz .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent,transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width:640px){.css-1mcymz .prism-code{font-size:1rem;}}@media screen and (min-width:768px){.css-1mcymz .prism-code{font-size:1.25rem;}}.css-1mcymz .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1mcymz .gatsby-highlight[data-language=''] .prism-code,.css-1mcymz .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1mcymz .token{display:inline-block;}.css-1mcymz p > code,.css-1mcymz li > code{background-color:var(--theme-ui-colors-gray-2,#edf2f7);color:var(--theme-ui-colors-gray-8,#2d3748);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1mcymz .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1,22,39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width:640px){.css-1mcymz .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width:768px){.css-1mcymz .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width:1024px){.css-1mcymz .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1mcymz .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1mcymz .gatsby-highlight pre code{float:left;min-width:100%;}.css-1mcymz .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white,#fff);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black,#000);font-size:12px;-webkit-letter-spacing:0.025rem;-moz-letter-spacing:0.025rem;-ms-letter-spacing:0.025rem;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1mcymz .gatsby-highlight pre[class~="language-javascript"]:before,.css-1mcymz .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1mcymz .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1mcymz .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white,#fff);}.css-1mcymz .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1mcymz .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black,#000);}.css-1mcymz .gatsby-highlight pre[class~="language-py"]:before,.css-1mcymz .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white,#fff);}.css-1mcymz .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1mcymz .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1mcymz .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1mcymz .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1mcymz .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1mcymz .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1mcymz .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1mcymz .gatsby-highlight pre[class~='language-json']:before,.css-1mcymz .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1mcymz .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1mcymz .gatsby-highlight > code[class*="language-"],.css-1mcymz .gatsby-highlight > pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1mcymz .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1mcymz .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary,#6b46c1);}.css-1mcymz .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1,22,39);}.css-1mcymz .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1mcymz .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black,#000);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width:640px){.css-1mcymz .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width:768px){.css-1mcymz .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width:1024px){.css-1mcymz .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1mcymz [data-name='live-preview'],.css-1mcymz [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width:640px){.css-1mcymz [data-name='live-preview'],.css-1mcymz [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width:768px){.css-1mcymz [data-name='live-preview'],.css-1mcymz [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width:1024px){.css-1mcymz [data-name='live-preview'],.css-1mcymz [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1mcymz .token-line{padding-right:1rem;}.css-1mcymz .highlight-line{background-color:rgb(2,55,81);border-left:4px solid rgb(2,155,206);}.css-1mcymz .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1mcymz .react-live-wrapper{position:relative;}.css-1mcymz .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width:640px){.css-1mcymz .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width:768px){.css-1mcymz .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width:1024px){.css-1mcymz .react-live-wrapper .code-copy-button{right:-1rem;}}</style><div id="skip-nav" class=" css-1mcymz"><style data-emotion-css="863s1o">.css-863s1o{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-863s1o{font-size:3rem;}}@media screen and (min-width:768px){.css-863s1o{font-size:3rem;}}@media screen and (min-width:1024px){.css-863s1o{font-size:4rem;}}</style><h1 class="css-863s1o">Kubernetes By Example (GKE)</h1><style data-emotion-css="1fkzbc2">.css-1fkzbc2{color:var(--theme-ui-colors-secondary,#5f6c80);margin-top:1rem;font-size:1rem;}.css-1fkzbc2 a{color:var(--theme-ui-colors-secondary,#5f6c80);}@media screen and (min-width:640px){.css-1fkzbc2{font-size:1rem;}}@media screen and (min-width:768px){.css-1fkzbc2{font-size:1.25rem;}}</style><p class="css-1fkzbc2"><time>27.03.2019</time> — <a class="css-688a3f" href="/tags/kubernetes">kubernetes</a> — <span>8<!-- --> min read</span></p><style data-emotion-css="f0b8g7">.css-f0b8g7{margin-top:4rem;margin-bottom:4rem;}.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0,0,0,0.15) 0px 32px 32px 0px,rgba(0,0,0,0.15) 0px 16px 16px 0px,rgba(0,0,0,0.15) 0px 8px 8px 0px,rgba(0,0,0,0.15) 0px 4px 4px 0px;}@media screen and (min-width:640px){.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width:768px){.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-f0b8g7"><style data-emotion-css="1ccrm8j">.css-1ccrm8j{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-1ccrm8j{font-size:1rem;}}@media screen and (min-width:768px){.css-1ccrm8j{font-size:1.25rem;}}</style><p class="css-1ccrm8j"><em class="css-0"><strong class="css-0">Note</strong>: This is a journal of my learnings as I walk through the entire <style data-emotion-css="1od09yo">.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="http://kubernetesbyexample.com" class="css-1od09yo">Kubernetes By Example</a> exercises on <code class="css-0">Google Kubernetes Engine</code>. I had writted this originally on <a href="https://github.com/bensooraj/bens-k8s-journal/tree/master/Basics/04-Kubernetes-By-Example" class="css-1od09yo">Github</a>.</em></p><style data-emotion-css="1p1kpni">.css-1p1kpni{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1p1kpni{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1p1kpni{font-size:1.875rem;}}@media screen and (min-width:1024px){.css-1p1kpni{font-size:2.25rem;}}</style><h3 class="css-1p1kpni">Contents <a id="top-contents" class="css-1od09yo"></a></h3><style data-emotion-css="15rlv7r">.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}</style><ol class="css-15rlv7r"><li class="css-0"><a href="#check-config-details" class="css-1od09yo">Check config details</a></li><li class="css-0"><a href="#spin-up-a-k8s-cluster-gke" class="css-1od09yo">Spin-up a k8s cluster (GKE)</a></li><li class="css-0"><a href="#pods" class="css-1od09yo">Pods</a></li><li class="css-0"><a href="#labels" class="css-1od09yo">Labels</a></li><li class="css-0"><a href="#deployments" class="css-1od09yo">Deployments</a></li><li class="css-0"><a href="#services" class="css-1od09yo">Services</a></li><li class="css-0"><a href="#service-discovery" class="css-1od09yo">Service Discovery</a></li><li class="css-0"><a href="#port-forward" class="css-1od09yo">Port Forward</a></li><li class="css-0"><a href="#health-checks" class="css-1od09yo">Health Checks</a></li><li class="css-0"><a href="#environment-variables" class="css-1od09yo">Environment Variables</a></li><li class="css-0"><a href="#namespaces" class="css-1od09yo">Namespaces</a></li><li class="css-0"><a href="#volumes" class="css-1od09yo">Volumes</a></li><li class="css-0"><a href="#secrets" class="css-1od09yo">Secrets</a></li><li class="css-0"><a href="#logging" class="css-1od09yo">Logging</a></li><li class="css-0"><a href="#jobs" class="css-1od09yo">Jobs</a></li><li class="css-0"><a href="#statefulset" class="css-1od09yo">StatefulSet</a></li><li class="css-0"><a href="#init-containers" class="css-1od09yo">Init Containers</a></li><li class="css-0"><a href="#nodes" class="css-1od09yo">Nodes</a></li><li class="css-0"><a href="#api-server-access" class="css-1od09yo">API Server access</a></li></ol><h3 class="css-1p1kpni">Check config details <a id="check-config-details" class="css-1od09yo"></a></h3><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><style data-emotion-css="l84w3r">.css-l84w3r{background-color:rgba(107,70,193,0.2);border:none;color:var(--theme-ui-colors-gray-2,#edf2f7);cursor:pointer;font-size:14px;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";-webkit-letter-spacing:0.025rem;-moz-letter-spacing:0.025rem;-ms-letter-spacing:0.025rem;letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width:640px){.css-l84w3r{font-size:14px;}}@media screen and (min-width:768px){.css-l84w3r{font-size:16px;}}.css-l84w3r[disabled]{cursor:not-allowed;}.css-l84w3r:not([disabled]):hover{background-color:var(--theme-ui-colors-primary,#6b46c1);color:var(--theme-ui-colors-white,#fff);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<style data-emotion-css="1gy8470">.css-1gy8470{border:0;-webkit-clip:rect(0,0,0,0);clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># List the active accounts:</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ gcloud auth list</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">   Credentialed Accounts</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">ACTIVE  ACCOUNT</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">*       xxyyzz@gmail.com</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">To set the active account, run:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">    $ gcloud config set account `ACCOUNT`</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Checkout the project we are currently in</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ gcloud config list project</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">[core]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">project = kubernetes-practice-219913</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Your active configuration is: [default]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"># List the default/current config values (I wanted the zone and region details):</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">$ gcloud config configurations list</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">NAME     IS_ACTIVE  ACCOUNT               PROJECT                     DEFAULT_ZONE   DEFAULT_REGION</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">default  True       xxyyzz@gmail.com  kubernetes-practice-219913  asia-south1-a  asia-south1</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Spin-up a k8s cluster (GKE) <a id="spin-up-a-k8s-cluster-gke" class="css-1od09yo"></a></h3><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a 3-node cluster and set kubectl context</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ gcloud container clusters create k8s-by-example --num-nodes=3</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Creating cluster k8s-by-example in asia-south1-a... Cluster is being health-checked (master is healthy)...done.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Created [https://container.googleapis.com/v1/projects/kubernetes-practice-219913/zones/asia-south1-a/clusters/k8s-by-example].</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># To inspect the contents of your cluster, go to: https://console.cloud.google.com/kubernetes/workload_/gcloud/asia-south1-a/k8s-by-example?project=kubernetes-practice-219913</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">kubeconfig entry generated for k8s-by-example.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">NAME            LOCATION       MASTER_VERSION  MASTER_IP       MACHINE_TYPE   NODE_VERSION  NUM_NODES  STATUS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">k8s-by-example  asia-south1-a  1.11.7-gke.4    35.200.190.186  n1-standard-1  1.11.7-gke.4  3          RUNNING</span></div></code></pre></div><p class="css-1ccrm8j">Creating a GKE cluster using <code class="css-0">gcloud</code> automatically makes an entry in the kubconfig file and also set the current context for <code class="css-0">kubectl</code>.</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Pods <a id="pods" class="css-1od09yo"></a></h3><style data-emotion-css="1gtwvjp">.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}</style><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">A pod is a collection of containers sharing a network and mount namespace and is the basic unit of deployment in Kubernetes. All containers in a pod are scheduled on the same node.</p></blockquote><p class="css-1ccrm8j">A dry-run <code class="css-0">kubectl run sise --image=mhausenblas/simpleservice:0.5.0 --port=9876 --dry-run=true -o yaml</code>, gives the following yaml output:</p><div class="gatsby-highlight" data-language="yaml"><pre class="prism-code language-yaml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-yaml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> apps/v1beta1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">  </span><span class="token key atrule">creationTimestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">    </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">      </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">  </span><span class="token key atrule">strategy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">      </span><span class="token key atrule">creationTimestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">        </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mhausenblas/simpleservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">0.5.0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">          </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">          </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9876</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">          </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain"></span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p class="css-1ccrm8j">Let&#x27;s run the pod using the image <code class="css-0">mhausenblas/simpleservice:0.5.0</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl run sise --image=mhausenblas/simpleservice:0.5.0 --port=9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">kubectl run --generator=deployment/apps.v1beta1 is DEPRECATED and will be removed in a future version. Use kubectl create instead.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.apps/sise created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List out the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get po -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                   READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sise-bf8d99689-qgkkk   1/1     Running   0          43s   10.12.1.6   gke-k8s-by-example-default-pool-f7f7edae-09cs   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Grab the IP address</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl describe pods sise-bf8d99689-qgkkk | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">IP:                 10.12.1.6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"># Get inside the pod and access the API using the IP address.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain"># This is accessible from the cluster as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">$ kubectl exec -it sise-bf8d99689-qgkkk sh</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">&gt; curl localhost:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">{&quot;host&quot;: &quot;localhost:9876&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;127.0.0.1&quot;}#</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">&gt; curl 10.12.1.6:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.6:9876&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.1.6&quot;}#</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain"># List the deployments</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">$ kubectl get deployments.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">NAME   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">sise   1         1         1            1           20m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain"># And delete it</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">$ kubectl delete deployments sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">deployment.extensions &quot;sise&quot; deleted</span></div></code></pre></div><style data-emotion-css="cobg18">.css-cobg18{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-cobg18{font-size:1.25rem;}}@media screen and (min-width:768px){.css-cobg18{font-size:1.25rem;}}@media screen and (min-width:1024px){.css-cobg18{font-size:1.5rem;}}</style><h5 class="css-cobg18">Using a configuration file</h5><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Apply a configuration to a resource by filename or stdin. The resource name must be specified. This resource will be created if it doesn&#x27;t exist yet. JSON and YAML formats are accepted.</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f pod/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/twocontainers created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">twocontainers   2/2     Running   0          1m    10.12.1.7   gke-k8s-by-example-default-pool-f7f7edae-09cs   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Get inside the container named &#x27;shell&#x27; within the pod named &#x27;twocontainers&#x27;</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl exec -it twocontainers -c shell -- bash</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">[root@twocontainers /]# curl localhost:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">{&quot;host&quot;: &quot;localhost:9876&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;127.0.0.1&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">[root@twocontainers /]# curl 10.12.1.7:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.7:9876&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.1.7&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain"># Clean up</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">$ kubectl delete pods twocontainers</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">pod &quot;twocontainers&quot; deleted</span></div></code></pre></div><h5 class="css-cobg18">Creating pods with resource limits</h5><p class="css-1ccrm8j">Set the cpu and memory limits at <code class="css-0">spec.containers[].resources.limits.cpu</code> and <code class="css-0">spec.containers[].resources.limits.memory</code> respectively.</p><div class="code-title"><div>Basics/04-Kubernetes-By-Example/pod/constraint-pod.yaml</div></div><div class="gatsby-highlight" data-language="yaml"><pre class="prism-code language-yaml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="Basics/04-Kubernetes-By-Example/pod/constraint-pod.yaml: copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">Basics/04-Kubernetes-By-Example/pod/constraint-pod.yaml: copy code to clipboard</span></button><code class="language-yaml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> containers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">constraint</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">  </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mhausenblas/simpleservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">0.5.0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9876</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">      </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">        </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;64Mi&quot;</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">        </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;500m&quot;</span></div></code></pre></div><p class="css-1ccrm8j">Create the pod with the resource limits set above</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">kubectl apply -f pod/constraint-pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># List the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME                    READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">containers-constraint   1/1     Running   0          14m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain"># Clean up</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">$ kubectl delete pods containers-constraint</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">pod &quot;containers-constraint&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Labels <a id="labels" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Labels are the mechanism you use to organize Kubernetes objects. A label is a key-value pair with certain restrictions concerning length and allowed values but without any pre-defined meaning.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the pod using labels/labels-1.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl create -f labels/labels-1.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/labelex created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Check the pods created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME      READY   STATUS             RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">labelex   0/1     ImagePullBackOff   0          31s</span></div></code></pre></div><p class="css-1ccrm8j">Oops! Looks like I made some mistake while specifying the image for the container. Let me checkout what went wrong using the <code class="css-0">describe</code> command:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl describe pods labelex</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">Name:               labelex</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">Namespace:          default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">Priority:           0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">PriorityClassName:  &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">Node:               gke-k8s-by-example-default-pool-41076e94-4n53/10.160.0.12</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">Start Time:         Fri, 15 Mar 2019 18:12:37 +0530</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">Labels:             env=development</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Annotations:        &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Status:             Pending</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">IP:                 10.12.2.8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Events:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">  Type     Reason          Age                   From                                                    Message</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">  ----     ------          ----                  ----                                                    -------</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">  Normal   Scheduled       5m10s                 default-scheduler                                       Successfully assigned default/labelex to gke-k8s-by-example-default-pool-41076e94-4n53</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">  Normal   SandboxChanged  5m1s (x2 over 5m3s)   kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Pod sandbox changed, it will be killed and re-created.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">  Normal   Pulling         4m10s (x3 over 5m9s)  kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  pulling image &quot;mhausenblas/simpleservice:0.5.&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">  Warning  Failed          4m5s (x3 over 5m4s)   kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Failed to pull image &quot;mhausenblas/simpleservice:0.5.&quot;: rpc error: code = Unknown desc = Error response from daemon: manifest for mhausenblas/simpleservice:0.5. not found</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">  Warning  Failed          4m5s (x3 over 5m4s)   kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Error: ErrImagePull</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">  Normal   BackOff         3m26s (x7 over 5m2s)  kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Back-off pulling image &quot;mhausenblas/simpleservice:0.5.&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">  Warning  Failed          3s (x19 over 5m2s)    kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Error: ImagePullBackOff</span></div></code></pre></div><p class="css-1ccrm8j">Skimming through the <code class="css-0">Events</code> section I found:</p><p class="css-1ccrm8j"><code class="css-0">Failed to pull image &quot;mhausenblas/simpleservice:0.5.&quot;: rpc error: code = Unknown desc = Error response from daemon: manifest for mhausenblas/simpleservice:0.5. not found</code></p><p class="css-1ccrm8j">Lol! I mentioned the wrong image name(<code class="css-0">mhausenblas/simpleservice:0.5.</code> instead of <code class="css-0">mhausenblas/simpleservice:0.5.0</code>). Let me correct that and apply the changes:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># This time the image is successfully pulled</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl describe pods labelex</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"># Events:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">#  Type     Reason          Age                   From                                                    Message</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">#   ----     ------          ----                  ----                                                    -------</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">#  Normal   Pulled          68s                   kubelet, gke-k8s-by-example-default-pool-41076e94-4n53  Successfully pulled image &quot;mhausenblas/simpleservice:0.5.0&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># List the pod created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">labelex   1/1     Running   0          11m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Show the labels as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl get pods --show-labels</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">labelex   1/1     Running   0          15m   env=development</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain"># Filter by the label now</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">$ kubectl get pods -l env=development</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">labelex   1/1     Running   0          16m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain"># Add a label to the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">$ kubectl label pods labelex ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">pod/labelex labeled</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain"># List them out again</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">$ kubectl get pods --show-labels</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">labelex   1/1     Running   0          17m   env=development,ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain"># Filter by the new label.</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">$ kubectl get pods --selector ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">labelex   1/1     Running   0          19m</span></div></code></pre></div><p class="css-1ccrm8j">I am really sorry for the spelling mistake with the label <code class="css-0">ownwer=bensooraj</code>. It hurts my eyes.</p><p class="css-1ccrm8j">Anyways, <code class="css-0">--selector</code> and <code class="css-0">-l</code> mean the same thing.</p><style data-emotion-css="14fixdb">.css-14fixdb{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-14fixdb{font-size:1.5rem;}}@media screen and (min-width:768px){.css-14fixdb{font-size:1.5rem;}}@media screen and (min-width:1024px){.css-14fixdb{font-size:1.875rem;}}</style><h4 class="css-14fixdb">Set based selectors</h4><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Kubernetes objects also support set-based selectors</p></blockquote><p class="css-1ccrm8j">We will launch another pod that has two labels (env=production and owner=bensooraj)</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a new pod using labels/labels-2.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f labels/labels-2.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># List out all the pods along with the labels</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get pods --show-labels</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME       READY   STATUS    RESTARTS   AGE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">labelex    1/1     Running   0          57m   env=development,ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">labelex2   1/1     Running   0          2m    env=production,owner=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Let&#x27;s get fancy here with selecting the labels</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl get pods --show-labels -l &#x27;env in (development)&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">labelex   1/1     Running   0          57m   env=development,ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain"># The following lists all pods that are either labelled with env=development or with env=production</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">$ kubectl get pods --show-labels -l &#x27;env in (development, production)&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">NAME       READY   STATUS    RESTARTS   AGE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">labelex    1/1     Running   0          57m   env=development,ownwer=bensooraj</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">labelex2   1/1     Running   0          3m    env=production,owner=bensooraj</span></div></code></pre></div><p class="css-1ccrm8j">I can even delete pods like that:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods -l &#x27;env in (development, production)&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;labelex&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod &quot;labelex2&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># You can see them getting terminated</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME       READY   STATUS        RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">labelex    1/1     Terminating   0          61m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">labelex2   1/1     Terminating   0          6m34s</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Deployments <a id="deployments" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">A deployment is a supervisor for pods, giving you fine-grained control over how and when a new pod version is rolled out as well as rolled back to a previous state.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a deploment called sise-deploy using</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f deployments/deployment-1.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.apps/sise-deployment created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># The deployment has started creating the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                               READY   STATUS              RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sise-deployment-6b9688f8f5-8xgr4   0/1     ContainerCreating   0          25s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">sise-deployment-6b9688f8f5-cwlvc   0/1     ContainerCreating   0          25s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"># After a while</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">NAME                               READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">sise-deployment-6b9688f8f5-8xgr4   1/1     Running   0          63s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">sise-deployment-6b9688f8f5-cwlvc   1/1     Running   0          63s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"># Check the deployment as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">$ kubectl get deployments -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">NAME              DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES                            SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">sise-deployment   2         2         2            2           3m    sise         mhausenblas/simpleservice:0.5.0   app=sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain"># List out the replica sets</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">$ kubectl get rs -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">NAME                         DESIRED   CURRENT   READY   AGE   CONTAINERS   IMAGES                            SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">sise-deployment-6b9688f8f5   2         2         2       4m    sise         mhausenblas/simpleservice:0.5.0   app=sise,pod-template-hash=2652449491</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Note the naming of the pods and replica set, derived from the deployment name.</p></blockquote><p class="css-1ccrm8j">Check the app using the pod IPs</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Get the pod IPs</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl describe pod sise-deployment-6b9688f8f5-8xgr4 | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">IP:                 10.12.1.6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl describe pod sise-deployment-6b9688f8f5-cwlvc | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">IP:                 10.12.2.5</span></div></code></pre></div><p class="css-1ccrm8j">SSH into one of the nodes of the cluster:</p><ul class="css-15rlv7r"><li class="css-0">Navigate to <code class="css-0">GCE &gt; Compute Engine &gt; VM instances</code>. Select one of the nodes</li><li class="css-0">Under the <code class="css-0">Connect</code> (against any one of the nodes), click on the <code class="css-0">SSH</code> drop-down and select <code class="css-0">View gcloud command</code> as shown below:
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:33.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABHUlEQVQoz11R2W6DQAzc//8tpL61idIKNU3YquHIEo4A4b6mGSOatitZNt6Z8eBVfdeirmt0XYd5nsGz5t818zRN+H/YJzdJEskqvbVSDMMguSxLNE2DMAyRpqn0mPu+xziOQszzHEVRCIY83vObA9XT5hlvu1fYto04juG6rhDieCGSZFkW9vu9iIUmlN71eoUxBsUdEwQGUZLfjdRQH59HmLMREN1RpG0frrMsk2Hu6QTtaGit4TiOiNMZsTzEs1bv+iBgz/OkQUHuZd1dWd6wednIPYfS1eqSNf+KQS45SgdfOAdnAbBZVdUfQT4YnZFMZwyuZX2gFcv9MtTBOeISXhBFkdhelvsQ5IDtdgvf90VkWUX/I7AG78j5BgYNFp+2x5S/AAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Deployment 1" title="Deployment 1" src="/static/15cfd0d12f0ea3b1125be0b9e8ab029e/7d769/deploy-1.png" srcSet="/static/15cfd0d12f0ea3b1125be0b9e8ab029e/5243c/deploy-1.png 240w,/static/15cfd0d12f0ea3b1125be0b9e8ab029e/ab158/deploy-1.png 480w,/static/15cfd0d12f0ea3b1125be0b9e8ab029e/7d769/deploy-1.png 960w,/static/15cfd0d12f0ea3b1125be0b9e8ab029e/87339/deploy-1.png 1440w,/static/15cfd0d12f0ea3b1125be0b9e8ab029e/c5a59/deploy-1.png 1668w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></li><li class="css-0">You will be presented with a command similar to: <code class="css-0">gcloud compute --project &quot;kubernetes-practice-219913&quot; ssh --zone &quot;asia-south1-a&quot; &quot;gke-k8s-by-example-default-pool-5574bdde-7k75&quot;</code></li></ul><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># From within the cluster, access the app running inside the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.1.6:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.6:9876&quot;, &quot;version&quot;: &quot;0.9&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.2.5:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">{&quot;host&quot;: &quot;10.12.2.5:9876&quot;, &quot;version&quot;: &quot;0.9&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">Rolling out an update</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Update the value of the environment variable SIMPLE_SERVICE_VERSION from &quot;0.9&quot; to &quot;1.0&quot;</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f deployments/deployment-2.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.apps/sise-deployment configured</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># You can see the roll-out happening</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                               READY   STATUS        RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sise-deployment-6b9688f8f5-8xgr4   1/1     Terminating   0          41m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">sise-deployment-6b9688f8f5-cwlvc   1/1     Terminating   0          41m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">sise-deployment-6c7b7f88c5-8mwr2   1/1     Running       0          16s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">sise-deployment-6c7b7f88c5-zxfgm   1/1     Running       0          18s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># After a while</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl get pods</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">NAME                               READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">sise-deployment-6c7b7f88c5-8mwr2   1/1     Running   0          2m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">sise-deployment-6c7b7f88c5-zxfgm   1/1     Running   0          2m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain"># Check out the replication set as well. A new replication set will be created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">$ kubectl get rs -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">NAME                         DESIRED   CURRENT   READY   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">sise-deployment-6b9688f8f5   0         0         0       42m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">sise-deployment-6c7b7f88c5   2         2         2       57s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain"># Check out the roll-out status</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">$ kubectl rollout status deployment sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">deployment &quot;sise-deployment&quot; successfully rolled out</span></div></code></pre></div><p class="css-1ccrm8j">Remember, the value change can also be rolled out using the command: <code class="css-0">kubectl edit deploy sise-deployment</code>.</p><p class="css-1ccrm8j">Verify the change made to the value of the environment variable by pinging the app</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Get the new set of pod IPs</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl describe pods sise-deployment-6c7b7f88c5-8mwr2 | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">IP:                 10.12.2.6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl describe pods sise-deployment-6c7b7f88c5-zxfgm | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">IP:                 10.12.1.7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># Curl the IPs from the node we SSHed into above</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.2.6:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">{&quot;host&quot;: &quot;10.12.2.6:9876&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.1.7:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.7:9876&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">Undo the roll-out</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Check-out the roll-out history</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl rollout history deployment sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.extensions/sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">REVISION  CHANGE-CAUSE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">1         &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">2         &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># Undo the roll-out</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl rollout undo deployment sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">deployment.extensions/sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain"># The roll-back has begun</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">$ kubectl get pods -o wide -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">NAME                               READY   STATUS        RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">sise-deployment-6b9688f8f5-74fnz   1/1     Running       0          8s    10.12.2.7   gke-k8s-by-example-default-pool-5574bdde-gkhk   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">sise-deployment-6b9688f8f5-gglnk   1/1     Running       0          10s   10.12.1.8   gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">sise-deployment-6c7b7f88c5-8mwr2   1/1     Terminating   0          13m   10.12.2.6   gke-k8s-by-example-default-pool-5574bdde-gkhk   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">sise-deployment-6c7b7f88c5-zxfgm   1/1     Terminating   0          13m   10.12.1.7   gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain"># List the roll-out history one more time</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">$ kubectl rollout history deployment sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">deployment.extensions/sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">REVISION  CHANGE-CAUSE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">2         &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">3         &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain"># Get the new IP addresses</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">$ kubectl describe pods sise-deployment-6b9688f8f5-74fnz | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">IP:                 10.12.2.7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">$ kubectl describe pods sise-deployment-6b9688f8f5-gglnk | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">IP:                 10.12.1.8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain"># Ping the app again from withing the cluster</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.2.7:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">{&quot;host&quot;: &quot;10.12.2.7:9876&quot;, &quot;version&quot;: &quot;0.9&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.1.8:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.8:9876&quot;, &quot;version&quot;: &quot;0.9&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">You can see the version rolled-back from <code class="css-0">&quot;version&quot;: &quot;1.0&quot;</code> to <code class="css-0">&quot;version&quot;: &quot;0.9&quot;</code>.</p><p class="css-1ccrm8j">Also, you can explicitly roll back to a specific revision using the flag <code class="css-0">--to-revision</code>. For example: <code class="css-0">kubectl rollout undo deployment sise-deployment</code></p><p class="css-1ccrm8j">Time to clean up!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete deployment sise-deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">deployment.extensions &quot;sise-deployment&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Pods going down! :P</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get pods -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME                               READY   STATUS        RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">sise-deployment-6b9688f8f5-74fnz   1/1     Terminating   0          6m27s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sise-deployment-6b9688f8f5-gglnk   1/1     Terminating   0          6m29s</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Services <a id="services" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">A service is an abstraction for pods, providing a stable, so called virtual IP (<code class="css-0">VIP</code>) address. While pods may come and go and with it their IP addresses, a service allows clients to reliably connect to the containers running in the pod using the VIP. The <code class="css-0">virtual</code> in VIP means it is not an actual IP address connected to a network interface, but its purpose is purely to forward traffic to one or more pods. Keeping the mapping between the VIP and the pods up-to-date is the job of <code class="css-0">kube-proxy</code>, a process that runs on every node, which queries the API server to learn about new services in the cluster.</p></blockquote><p class="css-1ccrm8j">Create the ReplicationController from <code class="css-0">rc.yaml</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl apply -f services/rc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"># Check the ReplicationController created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">$ kubectl get replicationcontrollers -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">NAME      DESIRED   CURRENT   READY   AGE   CONTAINERS   IMAGES                            SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">rc-sise   2         2         2       50s   rc-sise      mhausenblas/simpleservice:0.5.0   app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># And the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl get pod --show-labels -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">rc-sise-24vg4   1/1     Running   0          1m    10.12.1.9   gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;           app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">rc-sise-dm4p8   1/1     Running   0          1m    10.12.2.8   gke-k8s-by-example-default-pool-5574bdde-gkhk   &lt;none&gt;           app=rc-sise</span></div></code></pre></div><p class="css-1ccrm8j">Create the Service from <code class="css-0">svc.yaml</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl apply -f services/svc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">service/simple-service created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Get the service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get service -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME             TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE   SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">kubernetes       ClusterIP   10.15.240.1     &lt;none&gt;        443/TCP   3h    &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">simple-service   ClusterIP   10.15.255.188   &lt;none&gt;        80/TCP    29s   app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Get the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl get pods -l app=rc-sise -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">rc-sise-24vg4   1/1     Running   0          7m    10.12.1.9   gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">rc-sise-dm4p8   1/1     Running   0          7m    10.12.2.8   gke-k8s-by-example-default-pool-5574bdde-gkhk   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain"># Describe one of the pods and grab one of their IPs</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">$ kubectl describe pods rc-sise-24vg4 | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">IP:                 10.12.1.9</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain"># This can be accessed from one of three nodes running in the cluster</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.12.1.9:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">{&quot;host&quot;: &quot;10.12.1.9:9876&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">However, remember that pod IPs are ephemeral in nature and exist only as long as the pod exists. So, relying on pod IPs is not the right approach.</p><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">The service keeps track of the pods it forwards traffic to through the label, in our case <code class="css-0">app=sise</code>.</p></blockquote><p class="css-1ccrm8j">Let&#x27;s review the service that we created one more time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl get svc -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">NAME             TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE   SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">kubernetes       ClusterIP   10.15.240.1     &lt;none&gt;        443/TCP   3h    &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">simple-service   ClusterIP   10.15.255.188   &lt;none&gt;        80/TCP    6m    app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># Describe them</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">$ kubectl describe svc simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">Name:              simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Namespace:         default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Labels:            &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">Annotations:       kubectl.kubernetes.io/last-applied-configuration:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">                     {&quot;apiVersion&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Service&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;simple-service&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;ports&quot;:[{&quot;port&quot;:8...</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">Selector:          app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">Type:              ClusterIP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">IP:                10.15.255.188</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">Port:              &lt;unset&gt;  80/TCP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">TargetPort:        9876/TCP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">Endpoints:         10.12.1.9:9876,10.12.2.8:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">Session Affinity:  None</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">Events:            &lt;none&gt;</span></div></code></pre></div><p class="css-1ccrm8j">Note that the <code class="css-0">Endpoints</code> are actually pod IPs along with the port on which the application is running.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># The application can now be accessed using the clusterIP, from within the cluster</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ curl 10.15.255.188/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">{&quot;host&quot;: &quot;10.15.255.188&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.160.0.13&quot;}</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j"><a href="https://wiki.centos.org/HowTos/Network/IPTables" class="css-1od09yo"><code class="css-0">IPtables</code></a> makes the VIP <code class="css-0">10.15.255.188</code> forward the traffic to the pods. <code class="css-0">IPtables</code> is a long list of rules that tells the Linux kernel what to do with a certain IP package.</p></blockquote><p class="css-1ccrm8j">Let&#x27;s check them out:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># From within the cluster, that is from within a node(vm) running in the cluster</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ sudo iptables-save | grep simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">-A KUBE-SEP-XKHKNSMBAPANOQ3H -s 10.12.1.9/32 -m comment --comment &quot;default/simple-service:&quot; -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">-A KUBE-SEP-XKHKNSMBAPANOQ3H -p tcp -m comment --comment &quot;default/simple-service:&quot; -m tcp -j DNAT --to-destination 10.12.1.9:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">-A KUBE-SEP-XRG5PL6H4OXP3HUZ -s 10.12.2.8/32 -m comment --comment &quot;default/simple-service:&quot; -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">-A KUBE-SEP-XRG5PL6H4OXP3HUZ -p tcp -m comment --comment &quot;default/simple-service:&quot; -m tcp -j DNAT --to-destination 10.12.2.8:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">-A KUBE-SERVICES ! -s 10.12.0.0/14 -d 10.15.255.188/32 -p tcp -m comment --comment &quot;default/simple-service: cluster IP&quot; -m tcp --dport 80 -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">-A KUBE-SERVICES -d 10.15.255.188/32 -p tcp -m comment --comment &quot;default/simple-service: cluster IP&quot; -m tcp --dport 80 -j KUBE-SVC-LRSQWG6IZCA6IBBJ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">-A KUBE-SVC-LRSQWG6IZCA6IBBJ -m comment --comment &quot;default/simple-service:&quot; -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-XKHKNSMBAPANOQ3H</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">-A KUBE-SVC-LRSQWG6IZCA6IBBJ -m comment --comment &quot;default/simple-service:&quot; -j KUBE-SEP-XRG5PL6H4OXP3HUZ</span></div></code></pre></div><p class="css-1ccrm8j">I have no clue how to read the above table, however, this is the <code class="css-0">kube-proxy</code> defining rules to allow TCP connections back-n-forth the <code class="css-0">ClusterIP</code> <code class="css-0">10.15.255.188</code> and the pod IPs <code class="css-0">10.12.1.9:9876</code> and <code class="css-0">10.12.2.8:9876</code>.</p><p class="css-1ccrm8j">Let&#x27;s scale up our <code class="css-0">ReplicationController</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl scale replicationcontroller --replicas=3 rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">replicationcontroller/rc-sise scaled</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Check the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get pods --show-labels -o wide -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP           NODE                                            NOMINATED NODE   LABELS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">rc-sise-24vg4   1/1     Running   0          29m   10.12.1.9    gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;           app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">rc-sise-dm4p8   1/1     Running   0          29m   10.12.2.8    gke-k8s-by-example-default-pool-5574bdde-gkhk   &lt;none&gt;           app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">rc-sise-p7sk9   1/1     Running   0          14s   10.12.1.10   gke-k8s-by-example-default-pool-5574bdde-dnnl   &lt;none&gt;           app=rc-sise</span></div></code></pre></div><p class="css-1ccrm8j">We have one more pod IP to handle, <code class="css-0">10.12.1.10</code>.</p><p class="css-1ccrm8j">And guess what? The service <code class="css-0">simple-service</code> has already updated itself to account for the 3rd pod added to the <code class="css-0">ReplicationController</code>.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Check the Endpoints key. All the 3 pod IPs are now handled by the service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl describe service simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">Name:              simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">Namespace:         default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">Labels:            &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">Annotations:       kubectl.kubernetes.io/last-applied-configuration:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">                     {&quot;apiVersion&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Service&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;simple-service&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;ports&quot;:[{&quot;port&quot;:8...</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">Selector:          app=rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Type:              ClusterIP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">IP:                10.15.255.188</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">Port:              &lt;unset&gt;  80/TCP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">TargetPort:        9876/TCP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">Endpoints:         10.12.1.10:9876,10.12.1.9:9876,10.12.2.8:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">Session Affinity:  None</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Events:            &lt;none&gt;</span></div></code></pre></div><p class="css-1ccrm8j">Let&#x27;s also checkout the <code class="css-0">IPtables</code> as well from within the cluster:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-5574bdde-7k75 ~ $ sudo iptables-save | grep simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">-A KUBE-SEP-O5OGXTSGDHX72GHE -s 10.12.1.10/32 -m comment --comment &quot;default/simple-service:&quot; -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">-A KUBE-SEP-O5OGXTSGDHX72GHE -p tcp -m comment --comment &quot;default/simple-service:&quot; -m tcp -j DNAT --to-destination 10.12.1.10:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">-A KUBE-SEP-XKHKNSMBAPANOQ3H -s 10.12.1.9/32 -m comment --comment &quot;default/simple-service:&quot; -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">-A KUBE-SEP-XKHKNSMBAPANOQ3H -p tcp -m comment --comment &quot;default/simple-service:&quot; -m tcp -j DNAT --to-destination 10.12.1.9:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">-A KUBE-SEP-XRG5PL6H4OXP3HUZ -s 10.12.2.8/32 -m comment --comment &quot;default/simple-service:&quot; -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">-A KUBE-SEP-XRG5PL6H4OXP3HUZ -p tcp -m comment --comment &quot;default/simple-service:&quot; -m tcp -j DNAT --to-destination 10.12.2.8:9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">-A KUBE-SERVICES ! -s 10.12.0.0/14 -d 10.15.255.188/32 -p tcp -m comment --comment &quot;default/simple-service: cluster IP&quot; -m tcp --dport 80 -j KUBE-MARK-MASQ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">-A KUBE-SERVICES -d 10.15.255.188/32 -p tcp -m comment --comment &quot;default/simple-service: cluster IP&quot; -m tcp --dport 80 -j KUBE-SVC-LRSQWG6IZCA6IBBJ</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">-A KUBE-SVC-LRSQWG6IZCA6IBBJ -m comment --comment &quot;default/simple-service:&quot; -m statistic --mode random --probability 0.33332999982 -j KUBE-SEP-O5OGXTSGDHX72GHE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">-A KUBE-SVC-LRSQWG6IZCA6IBBJ -m comment --comment &quot;default/simple-service:&quot; -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-XKHKNSMBAPANOQ3H</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">-A KUBE-SVC-LRSQWG6IZCA6IBBJ -m comment --comment &quot;default/simple-service:&quot; -j KUBE-SEP-XRG5PL6H4OXP3HUZ</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">... the traffic to the service is equally split between the three pods by invoking the <code class="css-0">statistics</code> module of <code class="css-0">IPtables</code>.</p></blockquote><p class="css-1ccrm8j">I think the <code class="css-0">--probability</code> does that.</p><p class="css-1ccrm8j">Alrighty! Time to clean up:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete replicationcontrollers rc-sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">replicationcontroller &quot;rc-sise&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">$ kubectl delete svc simple-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">service &quot;simple-service&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">I think it makes more sense to delete the <code class="css-0">Service</code> first and then the <code class="css-0">ReplicationController</code>. I will do that next time.</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Service Discovery <a id="service-discovery" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Service discovery is the process of figuring out how to connect to a service. While there is a service discovery option based on environment variables available, the DNS-based service discovery is preferable. Note that DNS is a cluster add-on so make sure your Kubernetes distribution provides for one or install it yourself.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the RC from service-discovery/rc.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f service-discovery/rc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">replicationcontroller/rcsise created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Check the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME           READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">rcsise-mgdc8   1/1     Running   0          56s   10.12.2.6   gke-k8s-by-example-default-pool-dec3a359-jsgl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">rcsise-rwqxt   1/1     Running   0          56s   10.12.1.5   gke-k8s-by-example-default-pool-dec3a359-wrxk   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"># Create the service as well using service-discovery/svc.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl apply -f service-discovery/svc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">service/thesvc created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain"># Check the service that we just created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">$ kubectl get svc -o wide -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE    SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">kubernetes   ClusterIP   10.15.240.1     &lt;none&gt;        443/TCP   159m   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">thesvc       ClusterIP   10.15.241.194   &lt;none&gt;        80/TCP    11s    app=sise</span></div></code></pre></div><p class="css-1ccrm8j">I will now create a <strong class="css-0">jump pod</strong> in the <code class="css-0">default</code> namespace and try to simulate connecting to the <code class="css-0">thesvc</code> service from within the cluster, say, from another service.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the jump pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f service-discovery/jumppod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/jumppod created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pods created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME           READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">jumppod        1/1     Running   0          1m    10.12.2.7   gke-k8s-by-example-default-pool-dec3a359-jsgl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">rcsise-mgdc8   1/1     Running   0          31m   10.12.2.6   gke-k8s-by-example-default-pool-dec3a359-jsgl   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">rcsise-rwqxt   1/1     Running   0          31m   10.12.1.5   gke-k8s-by-example-default-pool-dec3a359-wrxk   &lt;none&gt;</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">The DNS add-on will make sure that our service <code class="css-0">thesvc</code> is available via the FQDN <code class="css-0">thesvc.default.svc.cluster.local</code> from other pods in the cluster.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Get inside the pod `jumppod`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl exec -it jumppod sh</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># From within jumppod, ping thesvc.default.svc.cluster.local</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">sh-4.2# ping thesvc.default.svc.cluster.local</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">PING thesvc.default.svc.cluster.local (10.15.241.194) 56(84) bytes of data.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">^C</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">--- thesvc.default.svc.cluster.local ping statistics ---</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">23 packets transmitted, 0 received, 100% packet loss, time 22522ms</span></div></code></pre></div><p class="css-1ccrm8j">The <code class="css-0">ping</code> results in <em class="css-0">100% packet loss</em>, probably, because <code class="css-0">ping</code> is not enable on the application image. However, you can see that the <code class="css-0">thesvc.default.svc.cluster.local</code> translating to the <code class="css-0">ClusterIP</code> <code class="css-0">10.15.241.194</code>.</p><p class="css-1ccrm8j">Let ping the application using the <code class="css-0">FQDN</code>, from withing the jumppod:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Using the FQDN</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">sh-4.2# curl thesvc.default.svc.cluster.local/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">{&quot;host&quot;: &quot;thesvc.default.svc.cluster.local&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.2.7&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Using the name of the service `thesvc`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">sh-4.2# curl thesvc/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">{&quot;host&quot;: &quot;thesvc&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.2.7&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain"># Or</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">sh-4.2# curl http://thesvc/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">{&quot;host&quot;: &quot;thesvc&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.2.7&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">Now, let&#x27;s try to reach the application from within one of the nodes in the cluster</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-dec3a359-jsgl ~ $ curl thesvc.default.svc.cluster.local/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"># curl: (6) Couldn&#x27;t resolve host &#x27;thesvc.default.svc.cluster.local&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-dec3a359-jsgl ~ $ curl thesvc/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># curl: (6) Couldn&#x27;t resolve host &#x27;thesvc&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-dec3a359-jsgl ~ $ curl http://thesvc/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"># curl: (6) Couldn&#x27;t resolve host &#x27;thesvc&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Bensooraj@gke-k8s-by-example-default-pool-dec3a359-jsgl ~ $ curl 10.15.241.194/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># {&quot;host&quot;: &quot;10.15.241.194&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.160.0.18&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">The <code class="css-0">FQDN</code> <code class="css-0">thesvc.default.svc.cluster.local</code> works only from within another <code class="css-0">pod</code> in the same <code class="css-0">namespace</code>, unlike the <code class="css-0">ClusterIP</code>.</p><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">To access a service that is deployed in a different namespace than the one you’re accessing it from, use a <code class="css-0">FQDN</code> in the form <code class="css-0">$SVC.$NAMESPACE.svc.cluster.local</code>.</p></blockquote><p class="css-1ccrm8j">Let&#x27;s attempt connecting to a service running in a different namespace</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a new namespace `other`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f service-discovery/other-ns.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">namespace/other created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Let&#x27;s list the namespaces</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get namespaces</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME          STATUS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">default       Active   3h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">kube-public   Active   3h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">kube-system   Active   3h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">other         Active   7s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Create a ReplicationController in the namespace `other`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl apply -f service-discovery/other-rc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain"># List all pods across all namespaces</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">$ kubectl get pods --all-namespaces</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">NAMESPACE     NAME                                                       READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">default       jumppod                                                    1/1     Running   0          42m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">default       rcsise-mgdc8                                               1/1     Running   0          1h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">default       rcsise-rwqxt                                               1/1     Running   0          1h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">other         other-rc-stk98                                             1/1     Running   0          4m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain"># Create the service in the namespace `other`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">$ kubectl apply -f service-discovery/other-svc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">service/other-sise-service created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain"># List all services across all namespaces</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">$ kubectl get svc --all-namespaces</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">NAMESPACE     NAME                   TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">default       kubernetes             ClusterIP   10.15.240.1     &lt;none&gt;        443/TCP         4h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">default       thesvc                 ClusterIP   10.15.241.194   &lt;none&gt;        80/TCP          1h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain">other         other-sise-service     ClusterIP   10.15.245.253   &lt;none&gt;        80/TCP          3s</span></div></code></pre></div><p class="css-1ccrm8j">Get inside the <code class="css-0">jumppod</code> and access the service running in the namespace <code class="css-0">other</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl exec -it jumppod sh</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"># Ping using the FQDN</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">sh-4.2# curl other-sise-service.other.svc.cluster.local/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">{&quot;host&quot;: &quot;other-sise-service.other.svc.cluster.local&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.2.7&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"># And the shorter version as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sh-4.2# curl other-sise-service.other/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">{&quot;host&quot;: &quot;other-sise-service.other&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;10.12.2.7&quot;}</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Summing up, DNS-based service discovery provides a flexible and generic way to connect to services across the cluster.</p></blockquote><p class="css-1ccrm8j">Clean up time!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Bring down the resources in the namespace `other`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl --namespace=other delete svc other-sise-service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">service &quot;other-sise-service&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl --namespace=other delete rc other-rc</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">replicationcontroller &quot;other-rc&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># And in the namespace `default`</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl delete svc thesvc</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">service &quot;thesvc&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl delete rc rcsise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">replicationcontroller &quot;rcsise&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">$ kubectl delete pod jumppod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">pod &quot;jumppod&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Port Forward <a id="port-forward" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">In the context of developing apps on Kubernetes it is often useful to quickly access a service from your local environment without exposing it using, for example, a load balancer or an ingress resource. In this case you can use <a href="https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/" class="css-1od09yo">port forwarding</a>.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Created a Deployment and a corresponding Service using port-forward/port-forward-1.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl create -f port-forward/port-forward-1.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.apps/sise-deploy created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">service/simpleservice created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># List the deployment</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">$ kubectl get deployment -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">NAME          DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES                            SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">sise-deploy   1         1         1            1           1m    sise         mhausenblas/simpleservice:0.5.0   app=sise</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"># And the service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl get service -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">NAME            TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)   AGE   SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">kubernetes      ClusterIP   10.15.240.1    &lt;none&gt;        443/TCP   13h   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">simpleservice   ClusterIP   10.15.244.55   &lt;none&gt;        80/TCP    1m    app=sise</span></div></code></pre></div><p class="css-1ccrm8j">The application running in GKE is either accessible from the pods or from any node of the cluster. We want to access the service from our local machine as well for development.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Fetch the pod IP</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl describe pods sise-deploy-56955c466c-dz99x | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">IP:                 10.12.2.9</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># From the local machine, let&#x27;s curl the pod&#x27;s IP</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">$ curl 10.12.2.9:9876/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain"># Or the ClusteIP created by the service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">$ curl 10.15.244.55/info</span></div></code></pre></div><p class="css-1ccrm8j">They return nothing. Let&#x27;s do a <code class="css-0">port-forward</code> now.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># To access the `simpleservice` service from the local environment on port 8080</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl port-forward service/simpleservice 8080:80</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">Forwarding from 127.0.0.1:8080 -&gt; 9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">Forwarding from [::1]:8080 -&gt; 9876</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># Curl localhost:8080</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">$ curl localhost:8080/info</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">{&quot;host&quot;: &quot;localhost:8080&quot;, &quot;version&quot;: &quot;0.5.0&quot;, &quot;from&quot;: &quot;127.0.0.1&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Perfecto!</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j"><strong class="css-0">Remember that port forwarding is not meant for production traffic but for development and experimentation.</strong></p></blockquote><p class="css-1ccrm8j">Clean up!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete -f port-forward/port-forward-1.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">deployment.apps &quot;sise-deploy&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">service &quot;simpleservice&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Health Checks <a id="health-checks" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">In order to verify if a container in a pod is healthy and ready to serve traffic, Kubernetes provides for a range of health checking mechanisms. Health checks, or probes as they are called in Kubernetes, are carried out by the <code class="css-0">kubelet</code> to determine when to restart a container (for <code class="css-0">livenessProbe</code>) and used by services and deployments to determine if a pod should receive traffic (for <code class="css-0">readinessProbe</code>).</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Pod which exposes /health for liveness health check. Kubernetes will start checking the /health endpoint, after initially waiting 2 seconds, every 5 seconds.</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f health-checks/liveness-pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/readiness-pod created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">readiness-pod   1/1     Running   0          1m    10.12.1.6   gke-k8s-by-example-default-pool-85e67e86-2xlh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Describe the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl describe pods readiness-pod</span></div></code></pre></div><p class="css-1ccrm8j">Relevant excerpt from <code class="css-0">kubectl describe pods readiness-pod</code>:</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:29.583333333333332%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA60lEQVQY052QzW6DMBCE/f7P1WMvqZRQFQGCtLaxIdgYMISfqVmpKM2hh470aeZg766GNU2DXUIIOOcob9tGzPOMZVmwrivxk/8Si+MY4ziCc44kSYg0TZHnObTSUErRMiElpJDQWtP7R7z35PsR7HKJMIfNp9MbDaqqGjJ8VmFY27YwxsBYi6YxR7YByk/s17MoumDoHErB0Qe/Tx6THzCNHv8Re3k9I+EW77nC183jqjt8Vj1RhHygHPLSIRMWlR1+df0IO0cfyIrQX1aAlxWkrsGlJi/1DUKFCgKqNuiGCf04Y7ovx8BnfQM0ncxTfsa/UwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Health 1" title="Health 1" src="/static/aa16287ce67e3ab08f199118cdf7150a/7d769/health-1.png" srcSet="/static/aa16287ce67e3ab08f199118cdf7150a/5243c/health-1.png 240w,/static/aa16287ce67e3ab08f199118cdf7150a/ab158/health-1.png 480w,/static/aa16287ce67e3ab08f199118cdf7150a/7d769/health-1.png 960w,/static/aa16287ce67e3ab08f199118cdf7150a/87339/health-1.png 1440w,/static/aa16287ce67e3ab08f199118cdf7150a/88b03/health-1.png 1920w,/static/aa16287ce67e3ab08f199118cdf7150a/916cf/health-1.png 2238w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></p><p class="css-1ccrm8j">Let&#x27;s launch a bad/unhealthy pod now, that has a container that randomly (in the time range 1 to 4 sec) does not return a 200 code.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Launch the bad pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f health-checks/bad-pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/bad-pod created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List out the pods; look at the number of restarts!</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">bad-pod         1/1     Running   4          4m    10.12.0.5   gke-k8s-by-example-default-pool-85e67e86-qbpv   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">readiness-pod   1/1     Running   0          17m   10.12.1.6   gke-k8s-by-example-default-pool-85e67e86-2xlh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"># Logging out the bad-pod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl logs -f bad-pod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># 2019-03-18T06:38:49 INFO This is simple service in version v0.5.0 listening on port 9876 [at line 142]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"># 2019-03-18T06:38:52 INFO /health serving from 10.12.0.5:9876 has been invoked from 10.12.0.1 [at line 79]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain"># 2019-03-18T06:38:55 INFO 200 GET /health (10.12.0.1) 3277.99ms [at line 1946]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain"># 2019-03-18T06:38:57 INFO /health serving from 10.12.0.5:9876 has been invoked from 10.12.0.1 [at line 79]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"># 2019-03-18T06:39:00 INFO 200 GET /health (10.12.0.1) 3540.73ms [at line 1946]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain"># 2019-03-18T06:39:02 INFO /health serving from 10.12.0.5:9876 has been invoked from 10.12.0.1 [at line 79]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain"># 2019-03-18T06:39:06 INFO 200 GET /health (10.12.0.1) 3778.49ms [at line 1946]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain"># ..</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain"># ..</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain"># Print out the events as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">$ kubectl describe pods bad-pod</span></div></code></pre></div><p class="css-1ccrm8j">Relevant excerpt from printing out the <code class="css-0">bad-pod</code> events:</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:21.666666666666668%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAw0lEQVQY002P6w6DIAyFff/X03m/4YaiomIMov45o02WjORLy6G0PYGUEkRd15jnGXScOzGOo79rGGOYbduwLAvWdcU0TVBKoe97ZhgG/nscB4J/kYq01hy7roMQAkVR+Fzw0LZt0UmFpFFI2xGVXFESnwX5W2M2FkFVVSCapkFZlgjDEFmWIYoipGmK1ytCkefsII4TCN+UG/uBv+2Jfd+ZgKzRhmTpui6Y3eA8Lay1eJ6Hue+boXeKpFHunGN++uX5AslhKq9ypqV7AAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Health 2" title="Health 2" src="/static/42c81cf870da93bdfd6642971f80cf27/7d769/health-2.png" srcSet="/static/42c81cf870da93bdfd6642971f80cf27/5243c/health-2.png 240w,/static/42c81cf870da93bdfd6642971f80cf27/ab158/health-2.png 480w,/static/42c81cf870da93bdfd6642971f80cf27/7d769/health-2.png 960w,/static/42c81cf870da93bdfd6642971f80cf27/87339/health-2.png 1440w,/static/42c81cf870da93bdfd6642971f80cf27/88b03/health-2.png 1920w,/static/42c81cf870da93bdfd6642971f80cf27/8355f/health-2.png 2560w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></p><p class="css-1ccrm8j">Let’s create a pod with a <code class="css-0">readinessProbe</code> that signals when the container is ready to serve traffica and kicks in after 10 seconds:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f health-checks/readiness-pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/readiness-pod-1 created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pods now</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME              READY   STATUS             RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">bad-pod           0/1     CrashLoopBackOff   11         27m   10.12.0.5   gke-k8s-by-example-default-pool-85e67e86-qbpv   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">readiness-pod     1/1     Running            0          40m   10.12.1.6   gke-k8s-by-example-default-pool-85e67e86-2xlh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">readiness-pod-1   1/1     Running            0          1m    10.12.1.7   gke-k8s-by-example-default-pool-85e67e86-2xlh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain"># Describe the pods events</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">$ kubectl describe pods readiness-pod-1</span></div></code></pre></div><p class="css-1ccrm8j">Relevant excerpt from printing out the <code class="css-0">readiness-pod-1</code> events:</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:24.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtklEQVQY032QbQvDIAyE/f//cAwZpVZLrXTVqn2/NRZH+2ETHk5CSO7ClFKI4wjnHPq+xzAMCe89QgiIMSL4U8ej79fb9z0pq0QJ7yyUFOCcQ0oJIQTqukbbttBao2l0UmNMWmytTWQTy7J8h7IHL/AUBs/iHEBOyOE0TbfNpMS2bVjX9ca1hxVlhVepoM07Dckx6U+biXmeE7n2N7I6IlLsWsnksOu6m1JMgm5KN6TBV8eZXPsARiqC97bU9UYAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Health 3" title="Health 3" src="/static/7768db289f3be6d6cd7cfc73ac370c17/7d769/health-3.png" srcSet="/static/7768db289f3be6d6cd7cfc73ac370c17/5243c/health-3.png 240w,/static/7768db289f3be6d6cd7cfc73ac370c17/ab158/health-3.png 480w,/static/7768db289f3be6d6cd7cfc73ac370c17/7d769/health-3.png 960w,/static/7768db289f3be6d6cd7cfc73ac370c17/87339/health-3.png 1440w,/static/7768db289f3be6d6cd7cfc73ac370c17/88b03/health-3.png 1920w,/static/7768db289f3be6d6cd7cfc73ac370c17/256cb/health-3.png 2558w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></p><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;bad-pod&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod &quot;readiness-pod&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">pod &quot;readiness-pod-1&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">I just realised; I messed up the pod names. Sorry!</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Environment Variables <a id="environment-variables" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">You can set environment variables for containers running in a pod and in addition, Kubernetes exposes certain runtime infos via environment variables automatically.</p></blockquote><p class="css-1ccrm8j">Launch a pod with the environment variable <code class="css-0">SIMPLE_SERVICE_VERSION</code> and value <code class="css-0">&quot;1.0&quot;</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Use environment-variables/env-pod.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f environment-variables/env-pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/envs created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME   READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">envs   1/1     Running   0          2m    10.12.2.6   gke-k8s-by-example-default-pool-6c270685-0hd5   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Grab the IP address:</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl describe pod envs | grep IP</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">IP:                 10.12.2.6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"># Curl the pod IP from inside the cluster</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">[CLUSTER] $ curl 10.12.2.6:9876/info &amp;&amp; echo</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">{&quot;host&quot;: &quot;10.12.2.6:9876&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;from&quot;: &quot;10.12.2.1&quot;}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">[CLUSTER] $ curl 10.12.2.6:9876/env &amp;&amp; echo</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">{&quot;version&quot;: &quot;1.0&quot;, &quot;env&quot;: &quot;{&#x27;LANG&#x27;: &#x27;C.UTF-8&#x27;, &#x27;KUBERNETES_PORT_443_TCP_PROTO&#x27;: &#x27;tcp&#x27;, &#x27;KUBERNETES_PORT_443_TCP&#x27;: &#x27;tcp://10.15.240.1:443&#x27;, &#x27;SIMPLE_SERVICE_VERSION&#x27;: &#x27;1.0&#x27;, &#x27;PYTHON_PIP_VERSION&#x27;: &#x27;9.0.1&#x27;, &#x27;KUBERNETES_SERVICE_HOST&#x27;: &#x27;10.15.240.1&#x27;, &#x27;HOSTNAME&#x27;: &#x27;envs&#x27;, &#x27;KUBERNETES_SERVICE_PORT_HTTPS&#x27;: &#x27;443&#x27;, &#x27;REFRESHED_AT&#x27;: &#x27;2017-04-24T13:50&#x27;, &#x27;GPG_KEY&#x27;: &#x27;C01E1CAD5EA2C4F0B8E3571504C367C218ADD4FF&#x27;, &#x27;KUBERNETES_PORT_443_TCP_ADDR&#x27;: &#x27;10.15.240.1&#x27;, &#x27;KUBERNETES_PORT&#x27;: &#x27;tcp://10.15.240.1:443&#x27;, &#x27;PATH&#x27;: &#x27;/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#x27;, &#x27;KUBERNETES_PORT_443_TCP_PORT&#x27;: &#x27;443&#x27;, &#x27;HOME&#x27;: &#x27;/root&#x27;, &#x27;KUBERNETES_SERVICE_PORT&#x27;: &#x27;443&#x27;, &#x27;PYTHON_VERSION&#x27;: &#x27;2.7.13&#x27;}&quot;}</span></div></code></pre></div><p class="css-1ccrm8j">Or, <code class="css-0">exec</code> into the <code class="css-0">envs</code> pod and printout the variables:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl exec envs -- sh -c &#x27;env&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">KUBERNETES_SERVICE_PORT=443</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">KUBERNETES_PORT=tcp://10.15.240.1:443</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">HOSTNAME=envs</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">PYTHON_PIP_VERSION=9.0.1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">HOME=/root</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">GPG_KEY=C01E1CAD5EA2C4F0B8E3571504C367C218ADD4FF</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">SIMPLE_SERVICE_VERSION=1.0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">KUBERNETES_PORT_443_TCP_ADDR=10.15.240.1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">KUBERNETES_PORT_443_TCP_PORT=443</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">KUBERNETES_PORT_443_TCP_PROTO=tcp</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">LANG=C.UTF-8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">PYTHON_VERSION=2.7.13</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">KUBERNETES_SERVICE_PORT_HTTPS=443</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">KUBERNETES_PORT_443_TCP=tcp://10.15.240.1:443</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">KUBERNETES_SERVICE_HOST=10.15.240.1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">PWD=/usr/src/app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">REFRESHED_AT=2017-04-24T13:50</span></div></code></pre></div><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;envs&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Namespaces <a id="namespaces" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j"><code class="css-0">Namespaces</code> provide for a scope of Kubernetes resource, carving up your cluster in smaller units. You can think of it as a workspace you’re sharing with other users.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a namespace named ben-test-namespace</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f namespaces/ns.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">namespace/ben-test-namespace created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List all the namespaces</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get ns</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                 STATUS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">ben-test-namespace   Active   14s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">default              Active   4h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">kube-public          Active   4h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">kube-system          Active   4h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Know more about the namespace</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl describe ns ben-test-namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Name:         ben-test-namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">Labels:       &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">Annotations:  kubectl.kubernetes.io/last-applied-configuration:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">                {&quot;apiVersion&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Namespace&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;ben-test-namespace&quot;}}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">Status:       Active</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">Resource Quotas</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain"> Name:                       gke-resource-quotas</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain"> Resource                    Used  Hard</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain"> --------                    ---   ---</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain"> count/ingresses.extensions  0     1G</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain"> count/jobs.batch            0     1G</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain"> pods                        0     1G</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain"> services                    0     1G</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">No resource limits.</span></div></code></pre></div><h5 class="css-cobg18">Launching k8s resources/objects in the newly created namespaces</h5><p class="css-1ccrm8j">There are two ways you can accomplishe this. First, using kubectl&#x27;s &quot;namespace&#x27; flag:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl --namespace=ben-test-namespace apply -f namespaces/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod/pod-in-ben-test-namespace created</span></div></code></pre></div><p class="css-1ccrm8j">Second, by mentioning the namespace in the pod yaml file, under <code class="css-0">metadata.namespace</code></p><div class="gatsby-highlight" data-language="yaml"><pre class="prism-code language-yaml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-yaml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> pod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">in</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ben</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">namespace</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ben</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span></div></code></pre></div><p class="css-1ccrm8j">Clean up time!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Pod in the newly created namespace</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl --namespace=ben-test-namespace delete pod pod-in-ben-test-namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod &quot;pod-in-ben-test-namespace&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Then the newly created namespace</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl delete namespaces ben-test-namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">namespace &quot;ben-test-namespace&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Volumes <a id="volumes" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">A Kubernetes volume is essentially a directory accessible to all containers running in a pod. In contrast to the container-local filesystem, the data in volumes is preserved across container restarts.</p></blockquote><p class="css-1ccrm8j">The medium backing a volume and its contents are determined by the volume type:</p><ul class="css-15rlv7r"><li class="css-0">node-local types such as <code class="css-0">emptyDir</code> or <code class="css-0">hostPath</code></li><li class="css-0">file-sharing types such as <code class="css-0">nfs</code></li><li class="css-0">cloud provider-specific types like <code class="css-0">awsElasticBlockStore</code>, <code class="css-0">azureDisk</code>, or <code class="css-0">gcePersistentDisk</code></li><li class="css-0">distributed file system types, for example <code class="css-0">glusterfs</code> or <code class="css-0">cephfs</code></li><li class="css-0">special-purpose types like <code class="css-0">secret</code>, <code class="css-0">gitRepo</code></li></ul><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the pod with the two containers</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f volumes/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/sharevol created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME       READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">sharevol   2/2     Running   0          48s   10.12.1.8   gke-k8s-by-example-default-pool-200a36e7-c33r   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Describe the pod (showing only relevant excerpts)</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl describe pod sharevol</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">Name:               sharevol</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">Namespace:          default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">IP:                 10.12.1.8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Containers:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">  c1:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">    Image:         centos:7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">    Mounts:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">      /tmp/xchange from xchange (rw)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">  c2:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">    Image:         centos:7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">    Mounts:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">      /temp/data from xchange (rw)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">Volumes:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">  xchange:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">    Type:    EmptyDir (a temporary directory that shares a pod&#x27;s lifetime)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">    Medium:</span></div></code></pre></div><p class="css-1ccrm8j">Let&#x27;s get inside the containers <code class="css-0">c1</code> and <code class="css-0">c2</code> and play around. Inside container <code class="css-0">c1</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Exec into the first container c1</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl exec -it sharevol -c c1 -- bash</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">[root@sharevol /]#</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">[root@sharevol /]# mount | grep xchange</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">/dev/sda1 on /tmp/xchange type ext4 (rw,relatime,commit=30,data=ordered)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># Create a</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">[root@sharevol /]# cd /tmp/xchange/</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">[root@sharevol xchange]# echo &quot;Hannah! I love you babe :)&quot; &gt; love.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">[root@sharevol xchange]# cat love.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Hannah! I love you babe :)</span></div></code></pre></div><p class="css-1ccrm8j">Now, let&#x27;s checkout the second container <code class="css-0">c2</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl exec -it sharevol -c c2 -- bash</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">[root@sharevol /]# cd /temp/data/</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"># Guess what!? The love.txt file which we created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># in the first container is available here</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">[root@sharevol data]# ls</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">love.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"># Let&#x27;s peek into the content too</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">[root@sharevol data]# cat love.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Hannah! I love you babe :)</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Note that in each container you need to decide where to mount the volume and that for <code class="css-0">emptyDir</code> you currently <strong class="css-0">can not</strong> specify resource consumption limits.</p></blockquote><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;sharevol&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Secrets <a id="secrets" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Secrets provide you with a mechanism to use information such as database passwords or an API keys in a safe (non-plain text) and reliable way with the following properties:</p></blockquote><ul class="css-15rlv7r"><li class="css-0">Secrets are namespaced objects, that is, exist in the context of a <code class="css-0">namespace</code></li><li class="css-0">You can access them via a volume or an environment variable from a container running in a pod</li><li class="css-0">The secret data on nodes is stored in <code class="css-0">tmpfs</code> volumes</li><li class="css-0">A per-secret size limit of <code class="css-0">1MB</code> exists</li><li class="css-0">The API server stores secrets as plaintext in etcd</li></ul><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Dump some random text to the file secrets/api-key.txt</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ echo -n &quot;k2hl1bflkh4lk23b41lkdlk23b4l341234&quot; &gt; secrets/api-key.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Create a new secret named apikey using the file secrets/api-key.txt</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl create secret generic apikey --from-file=secrets/api-key.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">secret/apikey created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># Describe the secret we just created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl describe secrets apikey</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Name:         apikey</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">Namespace:    default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">Labels:       &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">Annotations:  &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Type:  Opaque</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">Data</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">====</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">api-key.txt:  34 bytes</span></div></code></pre></div><p class="css-1ccrm8j">Let&#x27;s now use the secret that we just created</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a pod which uses the secret apikey</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f secrets/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/pod-with-secret created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME              READY   STATUS    RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">pod-with-secret   1/1     Running   0          4m    10.12.1.6   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># Get inside the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl exec -it pod-with-secret -- bash</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># You can see secret file api-key.txt at &quot;tmp/apikey/&quot;</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">[root@pod-with-secret /]# ls tmp/apikey/</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">api-key.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"># Let&#x27;s checkout out its content</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">[root@pod-with-secret /]# cat tmp/apikey/api-key.txt</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">k2hl1bflkh4lk23b41lkdlk23b4l341234</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Note that for service accounts Kubernetes automatically creates secrets containing credentials for accessing the API and modifies your pods to use this type of secret.</p></blockquote><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;pod-with-secret&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Logging <a id="logging" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Logging is one option to understand what is going on inside your applications and the cluster at large. Basic logging in Kubernetes makes the output a container produces available, which is a good use case for debugging.</p></blockquote><p class="css-1ccrm8j">Create a pod <code class="css-0">logme</code> that writes to <code class="css-0">stdout</code> and <code class="css-0">stderr</code>:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create the pod using logging/pod.yaml</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f logging/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/logme created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># View the five most recent log lines of the gen container in the logme pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl logs --tail=5 logme -c gen</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">Sat Mar 23 21:55:51 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">Sat Mar 23 21:55:52 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Sat Mar 23 21:55:52 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Sat Mar 23 21:55:53 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">Sat Mar 23 21:55:53 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Stream the log of the gen container in the logme pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl logs -f --since=5s logme -c gen</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">Sat Mar 23 21:57:28 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">Sat Mar 23 21:57:28 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">Sat Mar 23 21:57:29 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">Sat Mar 23 21:57:29 UTC 2019</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">.......</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">......</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">.....</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">....</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">...</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">..</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">.</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">..if you wouldn’t have specified --since=10s in the above command, you would have gotten all log lines from the start of the container. ...You can also view logs of pods that have already completed their lifecycle.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a new pod which counts down from 9 to 1</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f logging/oneshot.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod/oneshot created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># Let&#x27;s log it out</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl logs -p oneshot -c gen</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">9</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">5</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">4</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">3</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">1</span></div></code></pre></div><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Using the -p option you can print the logs for previous instances of the container in a pod</p></blockquote><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete pods --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">pod &quot;logme&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">pod &quot;oneshot&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Jobs <a id="jobs" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">A job in Kubernetes is a supervisor for pods carrying out batch processes, that is, a process that runs for a certain time to completion, for example a calculation or a backup operation.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a job called countdown that supervises a pod counting from 9 down to 1:</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f jobs/job.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">job.batch/countdown created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the job</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get jobs -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME        DESIRED   SUCCESSFUL   AGE   CONTAINERS   IMAGES     SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">countdown   1         1            31s   counter      centos:7   controller-uid=04f4458c-4dbc-11e9-a1d6-42010aa00ff8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"># List the pods as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">$ kubectl get pods -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">NAME              READY   STATUS      RESTARTS   AGE   IP          NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">countdown-td4vz   0/1     Completed   0          2m    10.12.1.9   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain"># Decribe a job</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">$ kubectl describe jobs countdown</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">Name:           countdown</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">Namespace:      default</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">Selector:       controller-uid=04f4458c-4dbc-11e9-a1d6-42010aa00ff8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">Labels:         controller-uid=04f4458c-4dbc-11e9-a1d6-42010aa00ff8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">                job-name=countdown</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">Parallelism:    1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">Completions:    1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">Start Time:     Sun, 24 Mar 2019 04:05:54 +0530</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">Completed At:   Sun, 24 Mar 2019 04:05:55 +0530</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">Duration:       1s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">Pods Statuses:  0 Running / 1 Succeeded / 0 Failed</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">Pod Template:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">  Labels:  controller-uid=04f4458c-4dbc-11e9-a1d6-42010aa00ff8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">           job-name=countdown</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">  Containers:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">   counter:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">    Image:      centos:7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">    Port:       &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">    Host Port:  &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">    Command:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain">      bin/bash</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain">      -c</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain">      for i in 9 8 7 6 5 4 3 2 1 ; do echo $i ; done</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">40</span><span class="token plain">    Environment:  &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">41</span><span class="token plain">    Mounts:       &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">42</span><span class="token plain">  Volumes:        &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">43</span><span class="token plain">Events:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">44</span><span class="token plain">  Type    Reason            Age    From            Message</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">45</span><span class="token plain">  ----    ------            ----   ----            -------</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">46</span><span class="token plain">  Normal  SuccessfulCreate  3m55s  job-controller  Created pod: countdown-td4vz</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">47</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">48</span><span class="token plain"># Checkout the output of the logs as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">49</span><span class="token plain">$ kubectl logs countdown-td4vz</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">50</span><span class="token plain">9</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">51</span><span class="token plain">8</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">52</span><span class="token plain">7</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">53</span><span class="token plain">6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">54</span><span class="token plain">5</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">55</span><span class="token plain">4</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">56</span><span class="token plain">3</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">57</span><span class="token plain">2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">58</span><span class="token plain">1</span></div></code></pre></div><p class="css-1ccrm8j">Clean up time:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete jobs countdown</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">job.batch &quot;countdown&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">StatefulSet <a id="statefulset" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">If you have a stateless app you want to use a <code class="css-0">Deployment</code>. However, for a stateful app you might want to use a <code class="css-0">StatefulSet</code>. Unlike a <code class="css-0">Deployment</code>, the <code class="css-0">StatefulSet</code> provides certain guarantees about the identity of the pods it is managing (that is, predictable names) and about the startup order. Two more things that are different compared to a <code class="css-0">Deployment</code>: for network communication you need to create a <code class="css-0">headless services</code> and for persistency the <code class="css-0">StatefulSet</code> manages a <code class="css-0">persistent volume</code> per pod.</p></blockquote><p class="css-1ccrm8j">We will be using an <a href="https://blog.openshift.com/kubernetes-statefulset-in-action/" class="css-1od09yo">educational Kubernetes-native NoSQL datastore</a> called <code class="css-0">mehdb</code> for this exercise.</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Verify if the yaml file is fine</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f statefulset/mehdb-sts-svc.yaml --dry-run=true</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">statefulset.apps/mehdb created (dry run)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">service/mehdb created (dry run)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"># Create the statefulset along with the persistent volume and the headless service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">$ kubectl apply -f statefulset/mehdb-sts-svc.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">statefulset.apps/mehdb created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">service/mehdb created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"># You can see how the pods are created in order</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">$ kubectl get pods -o wide -w</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">NAME      READY   STATUS              RESTARTS   AGE   IP       NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">mehdb-0   0/1     ContainerCreating   0          24s   &lt;none&gt;   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">mehdb-0   0/1   Running   0     43s   10.12.1.10   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">mehdb-0   1/1   Running   0     86s   10.12.1.10   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">mehdb-1   0/1   Pending   0     0s    &lt;none&gt;   &lt;none&gt;   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">mehdb-1   0/1   Pending   0     0s    &lt;none&gt;   &lt;none&gt;   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">mehdb-1   0/1   Pending   0     5s    &lt;none&gt;   &lt;none&gt;   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">mehdb-1   0/1   Pending   0     5s    &lt;none&gt;   gke-k8s-by-example-default-pool-635ddecf-30n4   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">mehdb-1   0/1   ContainerCreating   0     5s    &lt;none&gt;   gke-k8s-by-example-default-pool-635ddecf-30n4   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">mehdb-1   0/1   Running   0     32s   10.12.2.5   gke-k8s-by-example-default-pool-635ddecf-30n4   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">mehdb-1   1/1   Running   0     56s   10.12.2.5   gke-k8s-by-example-default-pool-635ddecf-30n4   &lt;none&gt;</span></div></code></pre></div><p class="css-1ccrm8j">A summary of all the resources that have been created:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Let&#x27;s checkout all the resources created</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl get sts,po,pvc,svc -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">NAME                     DESIRED   CURRENT   AGE   CONTAINERS   IMAGES</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">statefulset.apps/mehdb   2         2         8m    shard        quay.io/mhausenblas/mehdb:0.6</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME          READY   STATUS    RESTARTS   AGE   IP           NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">pod/mehdb-0   1/1     Running   0          8m    10.12.1.10   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">pod/mehdb-1   1/1     Running   0          7m    10.12.2.5    gke-k8s-by-example-default-pool-635ddecf-30n4   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">NAME                                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">persistentvolumeclaim/data-mehdb-0   Bound    pvc-8a824c22-4f7e-11e9-9777-42010aa00008   1Gi        RWO            standard       8m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">persistentvolumeclaim/data-mehdb-1   Bound    pvc-be0d2686-4f7e-11e9-9777-42010aa00008   1Gi        RWO            standard       7m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">NAME                 TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE   SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">service/kubernetes   ClusterIP   10.15.240.1   &lt;none&gt;        443/TCP    2d    &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">service/mehdb        ClusterIP   None          &lt;none&gt;        9876/TCP   8m    app=mehdb</span></div></code></pre></div><p class="css-1ccrm8j">Let&#x27;s access the <code class="css-0">StatefulSet</code> via a jump pod:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl run -it --rm jumppod --restart=Never --image=quay.io/mhausenblas/jump:0.2 -- sh</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">If you do not see a command prompt, try pressing enter.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">~ $</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># The headless service itself has no cluster IP and has created two endpoints for the pods mehdb-0 and mehdb-1 respectively. The DNS configuration now returns A record entries for the pods</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">~ $ nslookup mehdb</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">nslookup: cannot resolve &#x27;(null)&#x27;: Name does not resolve</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">Name:      mehdb</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">Address 1: 10.12.1.10 mehdb-0.mehdb.default.svc.cluster.local</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">Address 2: 10.12.2.5 mehdb-1.mehdb.default.svc.cluster.local</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Since there is no data in the datastore, /status?level=full should return a 0</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">~ $ curl mehdb:9876/status?level=full</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"># Let&#x27;s put some data now</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">~ $ echo &quot;test data&quot; &gt; /tmp/test</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">~ $ cat /tmp/test</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">test data</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">~ $ curl -sL -XPUT -T /tmp/test mehdb:9876/set/test</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">open /mehdbdata/test/content: no such file or directory</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain"># Unable to set value for the key test. So logging out mehdb-0&#x27;s activity reveals some</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain"># permissions issue. Will debug this later</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">$ kubectl logs mehdb-0 -f</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">2019/03/26 04:21:35 mehdb serving from mehdb-0:9876 using /mehdbdata as the data directory</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">2019/03/26 04:21:35 I am the leading shard, accepting both WRITES and READS</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">2019/03/26 05:09:14 Cannot write key test due to open /mehdbdata/test/content: no such file or directory</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain"># Found another issue</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">$ kubectl logs mehdb-1 -f</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">2019/03/26 05:29:48 Checking for new data from leader</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">2019/03/26 05:29:48 Cannot get keys from leader due to Get http://mehdb-0.default:9876/keys: dial tcp: lookup mehdb-0.default on 10.15.240.10:53: no such host</span></div></code></pre></div><p class="css-1ccrm8j"><code class="css-0">mehdb-1</code> should be querying at <code class="css-0">mehdb-0.mehdb.default:9876/keys</code> instead of at <code class="css-0">http://mehdb-0.default:9876/keys</code>.</p><p class="css-1ccrm8j">Clean up time!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">$ kubectl delete sts mehdb</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">statefulset.apps &quot;mehdb&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># We are left with the persistent volume and the service</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl get sts,po,pvc,svc -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">NAME                                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">persistentvolumeclaim/data-mehdb-0   Bound    pvc-8a824c22-4f7e-11e9-9777-42010aa00008   1Gi        RWO            standard       1h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">persistentvolumeclaim/data-mehdb-1   Bound    pvc-be0d2686-4f7e-11e9-9777-42010aa00008   1Gi        RWO            standard       1h</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">NAME                 TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE   SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">service/kubernetes   ClusterIP   10.15.240.1   &lt;none&gt;        443/TCP    2d    &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">service/mehdb        ClusterIP   None          &lt;none&gt;        9876/TCP   1h    app=mehdb</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"># Explicity delete the persistentvolumeclaims</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">$ for i in 0 1; do kubectl delete persistentvolumeclaims data-mehdb-$i; done</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">persistentvolumeclaim &quot;data-mehdb-0&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">persistentvolumeclaim &quot;data-mehdb-1&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain"># And the service as well</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">$ kubectl delete service mehdb</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">service &quot;mehdb&quot; deleted</span></div></code></pre></div><p class="css-1ccrm8j">This exercise wasn&#x27;t very successful though. :-/</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Init Containers <a id="init-containers" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">It’s sometimes necessary to prepare a container running in a pod. For example, you might want to wait for a service being available, want to configure things at runtime, or init some data in a database. In all of these cases, init containers are useful. Note that Kubernetes will execute all init containers (and they must all exit successfully) before the main container(s) are executed.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Create a deployment consisting of an init container that writes a message into a file at /ic/this and the main (long-running) container reading out this file:</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl apply -f init-containers/deploy.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.apps/ic-deploy created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># List the deployment and the pod</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get deploy,po -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                              DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES     SELECTOR</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">deployment.extensions/ic-deploy   1         1         1            1           29s   main         centos:7   app=ic</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">NAME                            READY   STATUS    RESTARTS   AGE   IP           NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">pod/ic-deploy-bf75cbf87-z8nh5   1/1     Running   0          30s   10.12.1.14   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"># Check the pod logs</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">$ kubectl logs ic-deploy-bf75cbf87-z8nh5 -f</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">INIT_DONE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">INIT_DONE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">INIT_DONE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">INIT_DONE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">INIT_DONE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">^C</span></div></code></pre></div><p class="css-1ccrm8j">Clean up time!</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Delete the deployment</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl delete deployments --all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">deployment.extensions &quot;ic-deploy&quot; deleted</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># And the pods are terminating, it can take some time</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ kubectl get deploy,po -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">NAME                            READY   STATUS        RESTARTS   AGE   IP           NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">pod/ic-deploy-bf75cbf87-z8nh5   0/1     Terminating   0          7m    10.12.1.14   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div></code></pre></div><p class="css-1ccrm8j">Time to move on though!</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">Nodes <a id="nodes" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">... nodes are the (virtual) machines where your workloads in shape of pods run.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Let&#x27;s list all the nodes:</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl get nodes -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">NAME                                            STATUS   ROLES    AGE   VERSION          INTERNAL-IP   EXTERNAL-IP      OS-IMAGE                             KERNEL-VERSION   CONTAINER-RUNTIME</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">gke-k8s-by-example-default-pool-635ddecf-1xsh   Ready    &lt;none&gt;   3d    v1.11.7-gke.12   10.160.0.29   35.200.209.198   Container-Optimized OS from Google   4.14.91+         docker://17.3.2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">gke-k8s-by-example-default-pool-635ddecf-30n4   Ready    &lt;none&gt;   3d    v1.11.7-gke.12   10.160.0.30   35.244.18.55     Container-Optimized OS from Google   4.14.91+         docker://17.3.2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">gke-k8s-by-example-default-pool-635ddecf-ll16   Ready    &lt;none&gt;   3d    v1.11.7-gke.12   10.160.0.28   35.200.217.246   Container-Optimized OS from Google   4.14.91+         docker://17.3.2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain"># Label one of the nodes</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">$ kubectl label nodes gke-k8s-by-example-default-pool-635ddecf-1xsh shouldrun=here</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">node/gke-k8s-by-example-default-pool-635ddecf-1xsh labeled</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain"># Now, create a pod to run on the specific node that we just labelled</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">$ kubectl apply -f nodes/pod.yaml</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">pod/onspecificnode created</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain"># It&#x27;s running on gke-k8s-by-example-default-pool-635ddecf-1xsh, which is the one we labelled</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">$ kubectl get po -o wide</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">NAME             READY   STATUS    RESTARTS   AGE   IP           NODE                                            NOMINATED NODE</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">onspecificnode   1/1     Running   0          38s   10.12.1.15   gke-k8s-by-example-default-pool-635ddecf-1xsh   &lt;none&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain"># You can learn more about node using describe (portion of the entire dump)</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">$ kubectl describe nodes gke-k8s-by-example-default-pool-635ddecf-1xsh</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">Addresses:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">  InternalIP:  10.160.0.29</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">  ExternalIP:  35.200.209.198</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">  Hostname:    gke-k8s-by-example-default-pool-635ddecf-1xsh</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">Capacity:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain"> cpu:                1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain"> ephemeral-storage:  98868448Ki</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain"> hugepages-2Mi:      0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain"> memory:             3787656Ki</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain"> pods:               110</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">Allocatable:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain"> cpu:                940m</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain"> ephemeral-storage:  47093746742</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain"> hugepages-2Mi:      0</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">40</span><span class="token plain"> memory:             2702216Ki</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">41</span><span class="token plain"> pods:               110</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">42</span><span class="token plain">System Info:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">43</span><span class="token plain"> Kernel Version:             4.14.91+</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">44</span><span class="token plain"> OS Image:                   Container-Optimized OS from Google</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">45</span><span class="token plain"> Operating System:           linux</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">46</span><span class="token plain"> Architecture:               amd64</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">47</span><span class="token plain"> Container Runtime Version:  docker://17.3.2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">48</span><span class="token plain"> Kubelet Version:            v1.11.7-gke.12</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">49</span><span class="token plain"> Kube-Proxy Version:         v1.11.7-gke.12</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">50</span><span class="token plain">PodCIDR:                     10.12.1.0/24</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">51</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">52</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">53</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">54</span><span class="token plain">.</span></div></code></pre></div><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p><h3 class="css-1p1kpni">API Server access <a id="api-server-access" class="css-1od09yo"></a></h3><blockquote class="css-1gtwvjp"><p class="css-1ccrm8j">Sometimes it’s useful or necessary to directly <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/http-proxy-access-api/" class="css-1od09yo">access the Kubernetes API server</a>, for exploratory or testing purposes.</p></blockquote><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># In one terminal, proxy the API to the local environment</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl proxy --port=8080</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">Starting to serve on 127.0.0.1:8080</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"># In another terminal, access the API</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">$ curl http://localhost:8080/api/v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">{</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">  &quot;kind&quot;: &quot;APIResourceList&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">  &quot;groupVersion&quot;: &quot;v1&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">  &quot;resources&quot;: [</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">    {</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">      &quot;name&quot;: &quot;bindings&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">      &quot;singularName&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">      &quot;namespaced&quot;: true,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">      &quot;kind&quot;: &quot;Binding&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">      &quot;verbs&quot;: [</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">        &quot;create&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">      ]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">    },</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">    .</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">    .</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">    .</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">    .</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">    {</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">      &quot;name&quot;: &quot;services/status&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">      &quot;singularName&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">      &quot;namespaced&quot;: true,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">      &quot;kind&quot;: &quot;Service&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">      &quot;verbs&quot;: [</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">        &quot;get&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">        &quot;patch&quot;,</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">        &quot;update&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">      ]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">    }</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">  ]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">}</span></div></code></pre></div><p class="css-1ccrm8j">Another method:</p><div class="gatsby-highlight" data-language="sh"><pre class="prism-code language-sh" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-l84w3r">Copy<span aria-roledescription="status" class="css-1gy8470">copy code to clipboard</span></button><code class="language-sh"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain"># Use kubectl directly</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">$ kubectl get --raw=/api/v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"># Check supported API versions</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">$ kubectl api-versions</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">apps/v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">apps/v1beta1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">apps/v1beta2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">batch/v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">batch/v1beta1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">v1</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain"># And resources (I am showing only a few)</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">$ kubectl api-resources</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">NAME                              SHORTNAMES   APIGROUP                       NAMESPACED   KIND</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">configmaps                        cm                                          true         ConfigMap</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">endpoints                         ep                                          true         Endpoints</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">events                            ev                                          true         Event</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">namespaces                        ns                                          false        Namespace</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">nodes                             no                                          false        Node</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">persistentvolumeclaims            pvc                                         true         PersistentVolumeClaim</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">persistentvolumes                 pv                                          false        PersistentVolume</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">pods                              po                                          true         Pod</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">replicationcontrollers            rc                                          true         ReplicationController</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">secrets                                                                       true         Secret</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">serviceaccounts                   sa                                          true         ServiceAccount</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">services                          svc                                         true         Service</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">daemonsets                        ds           apps                           true         DaemonSet</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">deployments                       deploy       apps                           true         Deployment</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">replicasets                       rs           apps                           true         ReplicaSet</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain">statefulsets                      sts          apps                           true         StatefulSet</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain">cronjobs                          cj           batch                          true         CronJob</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain">jobs                                           batch                          true         Job</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">40</span><span class="token plain">storageclasses                    sc           storage.k8s.io                 false        StorageClass</span></div></code></pre></div><p class="css-1ccrm8j">That&#x27;s the end!</p><p class="css-1ccrm8j">[<sub><sup><a href="#top-contents" class="css-1od09yo">GO TO TOP</a></sup></sub>]</p></section></div><style data-emotion-css="6x8z6y">.css-6x8z6y{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide,#cbd5e0);padding-top:1rem;}.css-6x8z6y a{color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-text-decoration:none;text-decoration:none;}.css-6x8z6y a:hover{color:var(--theme-ui-colors-heading,#000);-webkit-text-decoration:underline;text-decoration:underline;}.css-6x8z6y a:focus{color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-6x8z6y{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width:768px){.css-6x8z6y{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-6x8z6y"><div>© <!-- -->2021<!-- --> by <!-- -->Ben Sooraj<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/master/themes/gatsby-theme-minimal-blog" class="css-688a3f">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de/en" class="css-688a3f">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/kubernetes-by-example-gke";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-7ced8295869eb983463c.js"],"app":["/app-83334ac165a5a132fa00.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-b0556ce5127c1a3e2490.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-970be14a9aae153925c1.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-bf209d8c4b40168e07df.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-0e79983dde62b65b64ff.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-2463f65b120868d2315a.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-6d5261cb188f0457dd2e.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-35d09f4d1f6a70300fce.js"]};/*]]>*/</script><script src="/polyfill-7ced8295869eb983463c.js" nomodule=""></script><script src="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-2463f65b120868d2315a.js" async=""></script><script src="/aed2e917f30c051bccba91aa15989a75fd0bd633-550e32192ffced72d3f6.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-83334ac165a5a132fa00.js" async=""></script><script src="/framework-cd3e1e804d552fa282ef.js" async=""></script><script src="/webpack-runtime-55f2a76a00a71ac3be88.js" async=""></script></body></html>