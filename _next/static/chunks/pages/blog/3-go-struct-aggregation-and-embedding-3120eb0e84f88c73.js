(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[829],{5642:function(s,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/3-go-struct-aggregation-and-embedding",function(){return e(4998)}])},4998:function(s,n,e){"use strict";e.r(n);var a=e(5893),l=e(1151);function t(s){var n=Object.assign({h1:"h1",p:"p",strong:"strong",ul:"ul",li:"li",code:"code",pre:"pre",span:"span",h2:"h2",h3:"h3",ol:"ol",hr:"hr",em:"em"},(0,l.ah)(),s.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{children:"Struct aggregation and embedding in golang"}),"\n",(0,a.jsxs)(n.p,{children:["A ",(0,a.jsx)(n.strong,{children:"struct"}),","]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"is a collection of fields of various types, incuding other structs!"}),"\n",(0,a.jsx)(n.li,{children:"can be used to create user-defined data types"}),"\n",(0,a.jsx)(n.li,{children:"can have methods defined on them"}),"\n",(0,a.jsxs)(n.li,{children:["its fields and methods are accessed using the ",(0,a.jsx)(n.strong,{children:"dot"})," notation"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For example, ",(0,a.jsx)(n.code,{children:"Point"})," is a struct which has,"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["two fields ",(0,a.jsx)(n.code,{children:"X"})," and ",(0,a.jsx)(n.code,{children:"Y"})," of type ",(0,a.jsx)(n.code,{children:"float64"})]}),"\n",(0,a.jsxs)(n.li,{children:["has two methods ",(0,a.jsx)(n.code,{children:"String"})," and ",(0,a.jsx)(n.code,{children:"MakesNoSense"})]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-go",children:[(0,a.jsx)(n.span,{className:"hljs-comment",children:"// structs.go"}),"\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Struct definition"}),"\n",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"type"})," Point ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\tX, Y ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// String overrides how an entity of type `Point` "}),"\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// is printed (for example, to `stdout`)"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-params",children:"(p Point)"})]})," String() ",(0,a.jsx)(n.span,{className:"hljs-type",children:"string"})," {\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"return"})," fmt.Sprintf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Point {%f, %f}"'}),", p.X, p.Y)\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// MakesNoSense is just a dummy method"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-params",children:"(p Point)"})]})," MakesNoSense() {\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Point {%f, %f} is just a point!\\n"'}),", p.X, p.Y)\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"return"}),"\n}\n\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-title",children:"main"}),(0,a.jsx)(n.span,{className:"hljs-params",children:"()"})]})," {\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"var"})," pt Point\n\tpt.X = ",(0,a.jsx)(n.span,{className:"hljs-number",children:"1.123"})," ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// "}),"\n\tpt.Y = ",(0,a.jsx)(n.span,{className:"hljs-number",children:"2.123"})," ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// "}),"\n\n    fmt.Println(pt)\n    pt.MakesNoSense()\n}\n"]})}),"\n",(0,a.jsx)(n.p,{children:"results in,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"hljs language-sh",children:"$ go run structs.go\nPoint {1.123000, 2.123000}\nPoint {1.123000, 2.123000} is just a point!\n"})}),"\n",(0,a.jsx)(n.h2,{children:"Nested Structs"}),"\n",(0,a.jsxs)(n.p,{children:["Yes, you can define one struct inside another. There are two ways to go about it: ",(0,a.jsx)(n.strong,{children:"struct aggregation"})," and ",(0,a.jsx)(n.strong,{children:"struct embedding"}),"."]}),"\n",(0,a.jsx)(n.h3,{children:"Struct Aggregation"}),"\n",(0,a.jsxs)(n.p,{children:["This approach implies a ",(0,a.jsx)(n.code,{children:"has-a"})," relationship. For example, a line has two points (start and end) and can be declared as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-go",children:[(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Line struct has two fields of type Point"}),"\n",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"type"})," Line ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\tStart, End Point\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Distance methods calculates the euclidean distance "}),"\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// between the two Points"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-params",children:"(l Line)"})]})," Distance() ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"})," {\n\txDiff := math.Abs(l.Start.X - l.End.X)\n\tyDiff := math.Abs(l.Start.Y - l.End.Y)\n\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"return"})," math.Sqrt(math.Pow(xDiff, ",(0,a.jsx)(n.span,{className:"hljs-number",children:"2"}),") + math.Pow(yDiff, ",(0,a.jsx)(n.span,{className:"hljs-number",children:"2"}),"))\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Usage"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-title",children:"main"}),(0,a.jsx)(n.span,{className:"hljs-params",children:"()"})]})," {\n\tl := Line{\n\t\tStart: Point{\n\t\t\tX: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"2.304"}),",\n\t\t\tY: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"4.504"}),",\n\t\t},\n\t\tEnd: Point{\n\t\t\tX: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"30.607"}),",\n\t\t\tY: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"44.104"}),",\n\t\t},\n\t}\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Distance from %v to %v is %f units\\n"'}),", l.Start, l.End, l.Distance())\n}\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Distance from Point {2.304000, 4.504000} to Point {30.607000, 44.104000} is 48.674632 units"}),"\n"]})}),"\n",(0,a.jsxs)(n.p,{children:["Let's redefine ",(0,a.jsx)(n.code,{children:"Line"})," struct slightly differently using inline structs,"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-go",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"type"})," Line ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\tStart, End ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\t\tX ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t\tY ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t}\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Usage"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-title",children:"main"}),(0,a.jsx)(n.span,{className:"hljs-params",children:"()"})]})," {\n\tl := Line{\n\t\tStart: ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\t\t\tX ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t\t\tY ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t\t}{\n\t\t\tX: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"3.123"}),",\n\t\t\tY: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"8.123"}),",\n\t\t},\n\t\tEnd: ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\t\t\tX ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t\t\tY ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"\n\t\t}{\n\t\t\tX: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"4.123"}),",\n\t\t\tY: ",(0,a.jsx)(n.span,{className:"hljs-number",children:"7.123"}),",\n\t\t},\n\t}\n}\n"]})}),"\n",(0,a.jsxs)(n.p,{children:["This approach requires you to rely on ",(0,a.jsx)(n.code,{children:"anonymous structs"})," during initialization."]}),"\n",(0,a.jsx)(n.h3,{children:"Struct Embedding"}),"\n",(0,a.jsxs)(n.p,{children:["This approach implies an ",(0,a.jsx)(n.code,{children:"is-a"})," relationship. For example, a rectangle is a polygon and can be decalred as shown below:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-go",children:[(0,a.jsx)(n.span,{className:"hljs-comment",children:"// embed.go"}),"\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Polygon has just two fields for the sake of simplicity"}),"\n",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"type"})," Polygon ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\tWidth, Height ",(0,a.jsx)(n.span,{className:"hljs-type",children:"int"}),"\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Set width and height of the polygon"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-params",children:"(p *Polygon)"})]})," Set(w, h ",(0,a.jsx)(n.span,{className:"hljs-type",children:"int"}),") {\n\tp.Width = w\n\tp.Height = h\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Rectangle is a polygon, with one extra field 'color'"}),"\n",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"type"})," Rectangle ",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"struct"})," {\n\tcolor ",(0,a.jsx)(n.span,{className:"hljs-type",children:"string"}),"\n\tPolygon ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Notice the embedding?"}),"\n}\n\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// Area method can access the fields Width and Height even though"}),"\n",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// they are not directly defined within the Rectangle struct"}),"\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-params",children:"(r *Rectangle)"})]})," Area() ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"})," {\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"return"})," ",(0,a.jsx)(n.span,{className:"hljs-type",children:"float64"}),"(r.Width * r.Height)\n}\n\n",(0,a.jsxs)(n.span,{className:"hljs-function",children:[(0,a.jsx)(n.span,{className:"hljs-keyword",children:"func"})," ",(0,a.jsx)(n.span,{className:"hljs-title",children:"main"}),(0,a.jsx)(n.span,{className:"hljs-params",children:"()"})]})," {\n\t",(0,a.jsx)(n.span,{className:"hljs-keyword",children:"var"})," rect Rectangle\n\trect.Set(",(0,a.jsx)(n.span,{className:"hljs-number",children:"10"}),", ",(0,a.jsx)(n.span,{className:"hljs-number",children:"20"}),") ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// direct"}),"\n\trect.color = ",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Blue"'}),"\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Rectangle: %+v\\n"'}),", rect)\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Rectangle Width: %+v\\n"'}),", rect.Width) ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// direct"}),"\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Rectangle Height: %+v\\n"'}),", rect.Height) ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// direct"}),"\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Area of the rectangle is: %+v\\n"'}),", rect.Area())\n\n\trect.Polygon.Set(",(0,a.jsx)(n.span,{className:"hljs-number",children:"100"}),", ",(0,a.jsx)(n.span,{className:"hljs-number",children:"200"}),") ",(0,a.jsx)(n.span,{className:"hljs-comment",children:"// indirect"}),"\n\tfmt.Printf(",(0,a.jsx)(n.span,{className:"hljs-string",children:'"Rectangle: %+v\\n"'}),", rect)\n}\n"]})}),"\n",(0,a.jsx)(n.p,{children:"results in,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"hljs language-sh",children:"$ go run embed.go\nRectangle: {color:Blue Polygon:{Width:10 Height:20}}\nRectangle Width: 10\nRectangle Height: 20\nArea of the rectangle is: 200\nRectangle: {color:Blue Polygon:{Width:100 Height:200}}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You can see that ",(0,a.jsx)(n.code,{children:"rect"})," can access:"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Rectangle"})," struct's fields and methods"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Polygon"})," struct's fields and methods - both directly and indirectly"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"I am not sure if that's the correct way to put it, but these are my observations."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:["Note: ",(0,a.jsx)(n.em,{children:"This article is not an in-depth tutorial or treatment of Golang's syntax, semantics, design or implementation, but a journal of my learnings."})]})]})}n.default=function(s){var n=void 0===s?{}:s,e=Object.assign({},(0,l.ah)(),n.components).wrapper;return e?(0,a.jsx)(e,Object.assign({},n,{children:(0,a.jsx)(t,n)})):t(n)}}},function(s){s.O(0,[774,888,179],(function(){return n=5642,s(s.s=n);var n}));var n=s.O();_N_E=n}]);